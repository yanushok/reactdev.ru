---
description: –°—Ç–∞—Ç—å—è –æ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ React Query –∫–æ–¥–∞ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
---

# React Query –∏ Typescript

[TypeScript](https://www.typescriptlang.org/) ‚Äî —ç—Ç–æ üî•, —Ç–∞–∫–æ–≤–æ –æ–±—â–µ–µ –º–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤–æ frontend-—Å–æ–æ–±—â–µ—Å—Ç–≤–µ. –ú–Ω–æ–≥–∏–µ –æ–∂–∏–¥–∞—é—Ç, —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –±—É–¥—É—Ç –Ω–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ TypeScript –∏–ª–∏, –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—è—Ç —Ö–æ—Ä–æ—à–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤. –î–ª—è –º–µ–Ω—è, –µ—Å–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ TypeScript, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤ —è–≤–ª—è—é—Ç—Å—è –ª—É—á—à–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π. –û–Ω–∏ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—à–∏–±–∞—é—Ç—Å—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç—Ä–∞–∂–∞—é—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é. –Ø —á–∞—Å—Ç–æ —Å–º–æ—Ç—Ä—é –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤, –ø—Ä–µ–∂–¥–µ —á–µ–º —á–∏—Ç–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API.

React Query –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –±—ã–ª –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ JavaScript (v1), –∞ –∑–∞—Ç–µ–º –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –Ω–∞ TypeScript —Å v2. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –∏–º–µ–µ—Ç—Å—è –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π TypeScript.

–û–¥–Ω–∞–∫–æ –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–º–µ–Ω—Ç–æ–≤, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Å—Ç–æ–∏—Ç –±—ã—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–º –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å TypeScript –∏–∑-–∑–∞ —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∏–Ω–∞–º–∏—á–µ–Ω –∏ –Ω–µ–ø—Ä–∏–Ω—É–∂–¥–µ–Ω React Query. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∏—Ö –ø–æ –ø–æ—Ä—è–¥–∫—É, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –≤–∞—à –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –µ—â–µ –ª—É—á—à–µ.

## Generics {#generics}

React Query —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç [Generics](https://www.typescriptlang.org/docs/handbook/2/generics.html). –≠—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∞—Å, –∏ –æ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –∑–Ω–∞—Ç—å, –∫–∞–∫–æ–≥–æ _—Ç–∏–ø–∞_ –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞—à API –≤–µ—Ä–Ω–µ—Ç.

–°–µ–∫—Ü–∏—è –ø–æ TypeScript [–≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://tanstack.com/query/latest/docs/framework/react/typescript) –Ω–µ –æ—á–µ–Ω—å –æ–±—à–∏—Ä–Ω–∞, –∏ –æ–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞–º —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å Generics, –∫–æ—Ç–æ—Ä—ã–µ –æ–∂–∏–¥–∞–µ—Ç `useQuery` –ø—Ä–∏ –µ–≥–æ –≤—ã–∑–æ–≤–µ:

```ts title="explicit-generics"
function useGroups() {
  return useQuery<Group[], Error>({
    queryKey: ['groups'],
    queryFn: fetchGroups,
  })
}
```

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –±—ã–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞, –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ç–µ–ø–µ—Ä—å –æ–Ω–∞ **–Ω–µ** –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥.

–° —Ç–µ—á–µ–Ω–∏–µ–º –≤—Ä–µ–º–µ–Ω–∏ React Query –¥–æ–±–∞–≤–∏–ª –±–æ–ª—å—à–µ –æ–±–æ–±—â–µ–Ω–∏–π –≤ —Ö—É–∫ `useQuery` (—Ç–µ–ø–µ—Ä—å –∏—Ö —á–µ—Ç—ã—Ä–µ), –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏–∑-–∑–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –ü—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã–π –≤—ã—à–µ –∫–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø –¥–ª—è —Å–≤–æ–π—Å—Ç–≤–∞ `data` –Ω–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ö—É–∫–∞ –∫–∞–∫ `Group[] | undefined`, –∞ —Ç–∞–∫–∂–µ —É–±–µ–∂–¥–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ `error` –∏–º–µ–µ—Ç —Ç–∏–ø `Error | undefined`. –û–¥–Ω–∞–∫–æ —ç—Ç–æ –º–æ–∂–µ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ —Ç—Ä–µ–±—É—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –¥–≤–∞ –æ–±–æ–±—â–µ–Ω–∏—è.

### –ß–µ—Ç—ã—Ä–µ –¥–∂–µ–Ω–µ—Ä–∏–∫–∞ {#the-four-generics}

–í–æ—Ç —Ç–µ–∫—É—â–µ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ö—É–∫–∞ useQuery:

```ts title="useQuery"
export function useQuery<
  TQueryFnData = unknown,
  TError = unknown,
  TData = TQueryFnData,
  TQueryKey extends QueryKey = QueryKey
>
```

–ó–¥–µ—Å—å –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –º–Ω–æ–≥–æ –≤–µ—â–µ–π, –¥–∞–≤–∞–π—Ç–µ –ø–æ–ø—Ä–æ–±—É–µ–º —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è:

- `TQueryFnData`: —Ç–∏–ø, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π –∏–∑ `queryFn`. –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ `Group[]`.
- `TError`: —Ç–∏–ø –æ—à–∏–±–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –æ–∂–∏–¥–∞–µ–º –æ—Ç `queryFn`. –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ `Error`.
- `TData`: —Ç–∏–ø, –∫–æ—Ç–æ—Ä—ã–π –≤ –∫–æ–Ω–µ—á–Ω–æ–º –∏—Ç–æ–≥–µ –±—É–¥–µ—Ç —É –Ω–∞—à–µ–≥–æ —Å–≤–æ–π—Å—Ç–≤–∞ `data`. –≠—Ç–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Ç–æ–º —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –æ–ø—Ü–∏—é `select`, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–≤–æ–π—Å—Ç–≤–æ `data` –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç —Ç–æ–≥–æ, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `queryFn`. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω–æ –±—É–¥–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞–≤–Ω–æ —Ç–æ–º—É, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `queryFn`.
- `TQueryKey`: —Ç–∏–ø –Ω–∞—à–µ–≥–æ queryKey, –∞–∫—Ç—É–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è queryKey, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ –≤ –≤–∞—à queryFn.

–ö–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, —É –≤—Å–µ—Ö —ç—Ç–∏—Ö –æ–±–æ–±—â–µ–Ω–∏–π –µ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤—ã –∏—Ö –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ, TypeScript –±—É–¥–µ—Ç –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è —ç—Ç–∏—Ö —Ç–∏–ø–æ–≤. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ JavaScript:

```js title="default-parameters"
function multiply(a, b = 2) {
  return a * b
}

multiply(10) // ‚úÖ 20
multiply(10, 3) // ‚úÖ 30
```

### –í—ã–≤–æ–¥ —Ç–∏–ø–∞ {#type-inference}

TypeScript —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, –µ—Å–ª–∏ –≤—ã –ø–æ–∑–≤–æ–ª—è–µ—Ç–µ –µ–º—É —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å (–∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å) —Ç–∏–ø —á–µ–≥–æ-–ª–∏–±–æ. –≠—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –æ–±–ª–µ–≥—á–∞–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ (–ø–æ—Ç–æ–º—É —á—Ç–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –ø–µ—á–∞—Ç–∞—Ç—å –≤—Å–µ —Ç–∏–ø—ã üòÖ), –Ω–æ –∏ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º. –í–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –∫–æ–¥ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–æ—Ö–æ–∂–∏–º –Ω–∞ JavaScript. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞ —Ç–∏–ø–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å:

```ts title="type-inference"
const num = Math.random() + 5 // ‚úÖ `number`

// üöÄ –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –±—É–¥—É—Ç —Å—Ç—Ä–æ–∫–æ–≤—ã–º–∏
function greet(greeting = 'ciao') {
  return `${greeting}, ${getName()}`
}
```

Generics, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–≤–µ–¥–µ–Ω—ã –∏–∑ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, —á—Ç–æ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ. –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∏—Ö –≤—Ä—É—á–Ω—É—é, –Ω–æ –≤–æ –º–Ω–æ–≥–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.

```ts title="generic-identity"
function identity<T>(value: T): T {
  return value
}

// üö® –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å generic
let result = identity<number>(23)

// ‚ö†Ô∏è –∏–ª–∏ –æ–±—ä—è–≤–ª—è—Ç—å —Ç–∏–ø –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
let result: number = identity(23)

// üòé –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ `—Å—Ç—Ä–æ–∫—É`
let result = identity('react-query')
}
```

### –í—ã–≤–æ–¥ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Ç–∏–ø–∞ {#partial-type-argument-inference}

...–∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ TypeScript (—Å–º. [—ç—Ç–æ—Ç –æ—Ç–∫—Ä—ã—Ç—ã–π –≤–æ–ø—Ä–æ—Å](https://github.com/microsoft/TypeScript/issues/26242)). –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –≤—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç–µ –æ–¥–∏–Ω Generic, –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ. –û–¥–Ω–∞–∫–æ –∏–∑-–∑–∞ –Ω–∞–ª–∏—á–∏—è –≤ React Query –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è Generics, –º—ã –º–æ–∂–µ–º –Ω–µ –∑–∞–º–µ—Ç–∏—Ç—å —Å—Ä–∞–∑—É, —á—Ç–æ –æ–Ω–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã. –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–≤–æ–ª—å–Ω–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–º–∏. –î–∞–≤–∞–π—Ç–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä, –≥–¥–µ —ç—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π:

```ts title="default-generics"
function useGroupCount() {
  return useQuery<Group[], Error>({
    queryKey: ['groups'],
    queryFn: fetchGroups,
    select: (groups) => groups.length,
    // üö® Type '(groups: Group[]) => number' is not assignable to type '(data: Group[]) => Group[]'.
    // Type 'number' is not assignable to type 'Group[]'.ts(2322)
  })
}
```

–ü–æ—Å–∫–æ–ª—å–∫—É –º—ã –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ —Ç—Ä–µ—Ç–∏–π Generic, –≤—Å—Ç—É–ø–∞–µ—Ç –≤ —Å–∏–ª—É –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∫–æ—Ç–æ—Ä–æ–µ —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è `Group[]`, –Ω–æ –º—ã –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ç–∏–ø `number` –∏–∑ –Ω–∞—à–µ–π —Ñ—É–Ω–∫—Ü–∏–∏ `select`. –û–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç–æ - –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ—Ç–∏–π Generic:

```ts title="third-generic"
function useGroupCount() {
  // ‚úÖ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
  return useQuery<Group[], Error, number>({
    queryKey: ['groups'],
    queryFn: fetchGroups,
    select: (groups) => groups.length,
  })
}
```

–ü–æ–∫–∞ —É –Ω–∞—Å –Ω–µ—Ç –≤—ã–≤–æ–¥–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Ç–∏–ø–∞, –º—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–º, —á—Ç–æ —É –Ω–∞—Å –µ—Å—Ç—å.

–¢–∞–∫ –≤ —á–µ–º –∂–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞?

### –í—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Ç–∏–ø—ã {#infer-all-the-things}

–î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤–æ–æ–±—â–µ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –Ω–∏–∫–∞–∫–∏–µ –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –∏ –¥–∞—Ç—å TypeScript —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ –¥–µ–ª–∞—Ç—å. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —É `queryFn` –±—ã–ª —Ö–æ—Ä–æ—à–∏–π —Ç–∏–ø –≤–æ–∑–≤—Ä–∞—Ç–∞. –ö–æ–Ω–µ—á–Ω–æ, –µ—Å–ª–∏ –≤—ã –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –±–µ–∑ —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è —Ç–∏–ø–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞, —É –≤–∞—Å –±—É–¥–µ—Ç `any`, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –¥–∞–µ—Ç `axios` –∏–ª–∏ `fetch`:

```ts title="inlined-queryFn"
function useGroups() {
  // üö® –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç `any`
  return useQuery({
    queryKey: ['groups'],
    queryFn: () =>
      axios.get('groups').then((response) => response.data),
  })
}
```

–ï—Å–ª–∏ –≤—ã (–∫–∞–∫ –∏ —è) –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç–µ –¥–µ—Ä–∂–∞—Ç—å —Å–≤–æ–π —Å–ª–æ–π API –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–∞–º –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–∏–¥–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–∏–ø–æ–≤, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å _–Ω–µ—è–≤–Ω–æ–≥–æ_ `any`, —Ç–∞–∫ —á—Ç–æ React Query –º–æ–∂–µ—Ç –≤—ã–≤–µ—Å—Ç–∏ –æ—Å—Ç–∞–ª—å–Ω–æ–µ:

```ts title="inferred-types"
function fetchGroups(): Promise<Group[]> {
  return axios.get('groups').then((response) => response.data)
}

// ‚úÖ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ç–∏–ø–∞ `Group[] | undefined`
function useGroups() {
  return useQuery({ queryKey: ['groups'], queryFn: fetchGroups })
}

// ‚úÖ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ç–∏–ø–∞ `number | undefined`
function useGroupCount() {
  return useQuery({
    queryKey: ['groups'],
    queryFn: fetchGroups,
    select: (groups) => groups.length,
  })
}
```

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞:

- –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é —É–∫–∞–∑—ã–≤–∞—Ç—å –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã
- —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã 3-–π (select) –∏ 4-–π (QueryKey) –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã
- –±—É–¥–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã
- –∫–æ–¥ –º–µ–Ω–µ–µ –∑–∞–ø—É—Ç–∞–Ω–Ω—ã–π / –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª—å—à–µ –∫–∞–∫ JavaScript

### –ê —á—Ç–æ –Ω–∞—Å—á–µ—Ç –æ—à–∏–±–∫–∏? {#what-about-error}

–í—ã –º–æ–∂–µ—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å, –∞ —á—Ç–æ –Ω–∞—Å—á–µ—Ç –æ—à–∏–±–∫–∏? –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –æ–±–æ–±—â–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤, —Ç–∏–ø –æ—à–∏–±–∫–∏ –±—É–¥–µ—Ç –≤—ã–≤–µ–¥–µ–Ω –∫–∞–∫ `unknown`. –≠—Ç–æ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –±–∞–≥–æ–º, –ø–æ—á–µ–º—É —ç—Ç–æ –Ω–µ `Error`? –ù–æ —ç—Ç–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–µ–¥–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ JavaScript –≤—ã –º–æ–∂–µ—Ç–µ –±—Ä–æ—Å–∞—Ç—å _—á—Ç–æ —É–≥–æ–¥–Ω–æ_ - —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∏–ø `Error`:

```js title="totally-legit-throw-statements"
throw 5
throw undefined
throw Symbol('foo')
```

–ü–æ—Å–∫–æ–ª—å–∫—É React Query –Ω–µ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é Promise, –æ–Ω —Ç–∞–∫–∂–µ –Ω–µ –º–æ–∂–µ—Ç –∑–Ω–∞—Ç—å, –∫–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏ –æ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ—Ä–æ–∂–¥–∞—Ç—å. –¢–∞–∫ —á—Ç–æ —Ç–∏–ø `unknown` –≤–µ—Ä–µ–Ω. –ö–æ–≥–¥–∞ TypeScript –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–±–æ–±—â–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –æ–±–æ–±—â–µ–Ω–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ (—Å–º. [—ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏](https://github.com/microsoft/TypeScript/issues/10571)), –º—ã –º–æ–≥–ª–∏ –±—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ –ª—É—á—à–µ, –Ω–æ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ—à–∏–±–∫–∞–º–∏ –∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –ø—Ä–∏–±–µ–≥–∞—Ç—å –∫ –ø–µ—Ä–µ–¥–∞—á–µ –æ–±–æ–±—â–µ–Ω–Ω—ã—Ö —Ç–∏–ø–æ–≤, –º—ã –º–æ–∂–µ–º —Å—É–∑–∏—Ç—å —Ç–∏–ø —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π instanceof:

```jsx title="narrow-with-instanceof"
const groups = useGroups()

if (groups.error) {
  // üö® –≠—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ: Object is of type 'unknown'.ts(2571)
  return <div>An error occurred: {groups.error.message}</div>
}

// ‚úÖ –ø—Ä–æ–≤–µ—Ä–∫–∞ instanceOf —Å—É–∂–∞–µ—Ç—Å—è –¥–æ —Ç–∏–ø–∞ `Error`
if (groups.error instanceof Error) {
  return <div>An error occurred: {groups.error.message}</div>
}
```

–ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞–º –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –∫–∞–∫—É—é-—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –µ—Å—Ç—å –ª–∏ —É –Ω–∞—Å –æ—à–∏–±–∫–∞, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º instanceof –≤—ã–≥–ª—è–¥–∏—Ç —Å–æ–≤—Å–µ–º –Ω–µ —Ç–∞–∫–æ–π —É–∂ –∏ –ø–ª–æ—Ö–æ–π –∏ —Ç–∞–∫–∂–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —É –Ω–∞—à–µ–π –æ—à–∏–±–∫–∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –µ—Å—Ç—å —Å–≤–æ–π—Å—Ç–≤–æ message –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ —Ç–∞–∫–∂–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–æ–º—É, —á—Ç–æ TypeScript –ø–ª–∞–Ω–∏—Ä—É–µ—Ç –≤ –≤—ã–ø—É—Å–∫–µ 4.4, –≥–¥–µ –æ–Ω–∏ –≤–≤–µ–¥—É—Ç –Ω–æ–≤—ã–π —Ñ–ª–∞–≥ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞ `useUnknownInCatchVariables`, –≤ –∫–æ—Ç–æ—Ä–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ catch –±—É–¥—É—Ç –∏–º–µ—Ç—å —Ç–∏–ø `unknown` –≤–º–µ—Å—Ç–æ `any` (—Å–º. [–∑–¥–µ—Å—å](https://github.com/microsoft/TypeScript/issues/41016)).

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    –° –≤–µ—Ä—Å–∏–∏ 4, —Ç–∏–ø –¥–ª—è `Error` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `Error` –≤–º–µ—Å—Ç–æ `unknown`. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –Ω–∞ JavaScript –º–æ–∂–Ω–æ –±—Ä–æ—Å–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ (—á—Ç–æ –¥–µ–ª–∞–µ—Ç `unknown` —Å–∞–º—ã–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ç–∏–ø–æ–º), –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ –±—Ä–æ—Å–∞—é—Ç—Å—è Error (–∏–ª–∏ –∏—Ö –ø–æ–¥–∫–ª–∞—Å—Å—ã). –≠—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å –ø–æ–ª–µ–º –æ—à–∏–±–∫–∏ –≤ TypeScript –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Å–ª—É—á–∞–µ–≤.

    –ö—Ä–æ–º–µ —Ç–æ–≥–æ, React Query –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å –ø–æ–º–æ—â—å—é –º–æ–¥—É–ª—å–Ω–æ–≥–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:

    ```ts title="global-error-registration"
    declare module '@tanstack/react-query' {
      interface Register {
        defaultError: AxiosError
      }
    }
    ```

    –° —ç—Ç–∏–º –≤—ã –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ v4, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ `defaultError: unknown`.


## –°—É–∂–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ {#type-narrowing}

–Ø —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—é –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å React Query. –ü—Ä–µ–∂–¥–µ –≤—Å–µ–≥–æ, –∏–º–µ–Ω–∞, —Ç–∞–∫–∏–µ –∫–∞–∫ `data` –∏ `error`, –¥–æ–≤–æ–ª—å–Ω–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã (–Ω–∞–º–µ—Ä–µ–Ω–Ω–æ —Ç–∞–∫–∏–µ), –ø–æ—ç—Ç–æ–º—É –≤—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≤—Å–µ —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–∏–º–µ–Ω—É–µ—Ç–µ –∏—Ö. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ü–µ–ª–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Å–æ—Ö—Ä–∞–Ω–∏—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ç–æ–≥–æ, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —ç—Ç–æ –∏–ª–∏ –æ—Ç–∫—É–¥–∞ –∏–¥–µ—Ç –æ—à–∏–±–∫–∞. –≠—Ç–æ –¥–∞–ª–µ–µ –ø–æ–º–æ–∂–µ—Ç TypeScript —Å—É–∑–∏—Ç—å —Ç–∏–ø—ã –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –ø–æ–ª—è —Å—Ç–∞—Ç—É—Å–∞ –∏–ª–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ –±—É–ª–µ–≤—ã—Ö –ø–æ–ª–µ–π —Å—Ç–∞—Ç—É—Å–∞, —á—Ç–æ –Ω–µ —É–¥–∞–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏–∏:

```ts title="type-narrowing"
const { data, isSuccess } = useGroups()
if (isSuccess) {
  // üö® –ó–¥–µ—Å—å –¥–∞–Ω–Ω—ã–µ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –±—É–¥—É—Ç `Group[] | undefined`
}

const groupsQuery = useGroups()
if (groupsQuery.isSuccess) {
  // ‚úÖ groupsQuery.data —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç `Group[]`
}
```

–≠—Ç–æ –Ω–µ –∏–º–µ–µ—Ç –Ω–∏–∫–∞–∫–æ–≥–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ React Query, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–æ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç TypeScript. –£ [@danvdk](https://twitter.com/danvdk) –µ—Å—Ç—å [—Ö–æ—Ä–æ—à–µ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ](https://twitter.com/danvdk/status/1363614288103964672) —ç—Ç–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    –û—Ç–ª–∏—á–Ω–æ! –£–ª—É—á—à–µ–Ω–∏—è –≤ TypeScript 4.6, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ [–∞–Ω–∞–ª–∏–∑ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ—Ç–æ–∫–æ–º –¥–ª—è –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–∞–∑–ª–∏—á–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–π](https://devblogs.microsoft.com/typescript/announcing-typescript-4-6/#cfa-destructured-discriminated-unions), —Å–¥–µ–ª–∞–ª–∏ —Ç–∞–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤–æ–∑–º–æ–∂–Ω—ã–º–∏. –†–∞–¥, —á—Ç–æ –æ–Ω–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞—é—Ç —è–∑—ã–∫! üöÄ

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø—Ü–∏–∏ enabled {#type-safety-with-the-enabled-option}

–Ø –≤—ã—Ä–∞–∂–∞–ª —Å–≤–æ—é üíñ –ø–æ –ø–æ–≤–æ–¥—É –æ–ø—Ü–∏–∏ [`enabled`](practical.md#the-enabled-option-is-very-powerful) —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞, –Ω–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–∏–ø–æ–≤ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–º–Ω–æ–≥–æ —Å–ª–æ–∂–Ω—ã–º, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ –¥–ª—è [–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤](https://tanstack.com/query/latest/docs/framework/react/guides/dependent-queries) –∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –≤–∞—à –∑–∞–ø—Ä–æ—Å –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –µ—â–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã:

```ts title="the-enabled-option"
function fetchGroup(id: number): Promise<Group> {
  return axios.get(`group/${id}`).then((response) => response.data)
}

function useGroup(id: number | undefined) {
  return useQuery({
    queryKey: ['group', id],
    queryFn: () => fetchGroup(id),
    enabled: Boolean(id),
  })
  // üö® Argument of type 'number | undefined' is not assignable to parameter of type 'number'.
  //  Type 'undefined' is not assignable to type 'number'.ts(2345)
}
```

–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ TypeScript –ø—Ä–∞–≤, `id` –º–æ–∂–µ—Ç –±—ã—Ç—å `undefined`: –æ–ø—Ü–∏—è `enabled` –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏–µ —Ç–∏–ø–∞. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å—Ç—å —Å–ø–æ—Å–æ–±—ã –æ–±–æ–π—Ç–∏ –æ–ø—Ü–∏—é `enabled`, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–∑–≤–∞–≤ –º–µ—Ç–æ–¥ `refetch`, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã–π –∏–∑ `useQuery`. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `id` –º–æ–∂–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –±—ã—Ç—å `undefined`.

–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± –∑–¥–µ—Å—å, –µ—Å–ª–∏ –≤—ã –Ω–µ –ª—é–±–∏—Ç–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä [non-null assertion](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html#non-null-assertion-operator), ‚Äî –ø—Ä–∏–Ω—è—Ç—å, —á—Ç–æ `id` –º–æ–∂–µ—Ç –±—ã—Ç—å `undefined`, –∏ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å Promise –≤ `queryFn`. –≠—Ç–æ –Ω–µ–º–Ω–æ–≥–æ –¥—É–±–ª–∏—Ä—É–µ—Ç –∫–æ–¥, –Ω–æ —Ç–∞–∫–∂–µ —è–≤–ª—è–µ—Ç—Å—è —è–≤–Ω—ã–º –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º:

```ts title="explicit-id-check"
function fetchGroup(id: number | undefined): Promise<Group> {
  // ‚úÖ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ id –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å `undefined`
  return typeof id === 'undefined'
    ? Promise.reject(new Error('Invalid id'))
    : axios.get(`group/${id}`).then((response) => response.data)
}

function useGroup(id: number | undefined) {
  return useQuery({
    queryKey: ['group', id],
    queryFn: () => fetchGroup(id),
    enabled: Boolean(id),
  })
}
```

## Optimistic Updates {#optimistic-updates}

–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ TypeScript ‚Äî —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–∞—è –∑–∞–¥–∞—á–∞, –ø–æ—ç—Ç–æ–º—É –º—ã —Ä–µ—à–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ç–æ –∫–∞–∫ –∏—Å—á–µ—Ä–ø—ã–≤–∞—é—â–∏–π [–ø—Ä–∏–º–µ—Ä](https://tanstack.com/query/latest/docs/framework/react/examples/optimistic-updates-ui) –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.

–í–∞–∂–Ω–∞—è —á–∞—Å—Ç—å: –≤—ã –¥–æ–ª–∂–Ω—ã —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –∞—Ä–≥—É–º–µ–Ω—Ç–∞ `variables`, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º–æ–≥–æ –≤ `onMutate`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –Ω–∞–∏–ª—É—á—à–∏–π –≤—ã–≤–æ–¥ —Ç–∏–ø–æ–≤. –Ø –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ –ø–æ–Ω–∏–º–∞—é, –ø–æ—á–µ–º—É —Ç–∞–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –Ω–æ, –∫–∞–∂–µ—Ç—Å—è, —ç—Ç–æ —Å–Ω–æ–≤–∞ —Å–≤—è–∑–∞–Ω–æ —Å –≤—ã–≤–æ–¥–æ–º –¥–∂–µ–Ω–µ—Ä–∏–∫ —Ç–∏–ø–æ–≤. –í–∑–≥–ª—è–Ω–∏—Ç–µ [–Ω–∞ —ç—Ç–æ—Ç](https://github.com/tannerlinsley/react-query/pull/1366#discussion_r538459890) –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    TypeScript 4.7 –≤–Ω–µ—Å [—É–ª—É—á—à–µ–Ω–∏—è –≤ –≤—ã–≤–æ–¥ —Ç–∏–ø–æ–≤ –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –º–µ—Ç–æ–¥–æ–≤](https://devblogs.microsoft.com/typescript/announcing-typescript-4-7-beta/#improved-function-inference-in-objects-and-methods), —á—Ç–æ —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É. –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –≤—ã–≤–æ–¥–∏—Ç—å —Ç–∏–ø—ã –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Å–∏–ª–∏–π. ü•≥

    –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ React Query v5 –ø–æ—è–≤–∏–ª—Å—è [–Ω–æ–≤—ã–π —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è](https://tanstack.com/query/v5/docs/react/guides/optimistic-updates#via-the-ui), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ —É–ø—Ä–æ—Å—Ç–∏—Ç—å –∏—Ö –Ω–∞–ø–∏—Å–∞–Ω–∏–µ.

## useInfiniteQuery {#useinfinitequery}

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ —Ç–∏–ø–∏–∑–∞—Ü–∏—è `useInfiniteQuery` –Ω–∏—á–µ–º –Ω–µ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç–∏–ø–∏–∑–∞—Ü–∏–∏ `useQuery`. –ó–∞–º–µ—Ç–Ω—ã–º ¬´–ø–æ–¥–≤–æ–¥–Ω—ã–º –∫–∞–º–Ω–µ–º¬ª —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ `pageParam`, –∫–æ—Ç–æ—Ä–æ–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `queryFn`, –∏–º–µ–µ—Ç —Ç–∏–ø `any`. –í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ —ç—Ç–æ, –∫–æ–Ω–µ—á–Ω–æ, –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å, –Ω–æ –ø–æ–∫–∞ –æ–Ω–æ any, –≤–µ—Ä–æ—è—Ç–Ω–æ, –ª—É—á—à–µ —è–≤–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ:

```ts title="useInfiniteQuery"
type GroupResponse = { next?: number; groups: Group[] }
const queryInfo = useInfiniteQuery({
  queryKey: ['groups'],
  // ‚ö†Ô∏è explicitly type pageParam to override `any`
  queryFn: ({
    pageParam = 0,
  }: {
    pageParam: GroupResponse['next']
  }) => fetchGroups(groups, pageParam),
  getNextPageParam: (lastGroup) => lastGroup.next,
})
```

–ï—Å–ª–∏ `fetchGroups` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `GroupResponse`, `lastGroup` –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Å–≤–æ–π —Ç–∏–ø –∫—Ä–∞—Å–∏–≤–æ –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–º, –∏ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ —Ç–∏–ø –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `pageParam`.

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    –≠—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –≤–µ—Ä—Å–∏–∏ 5, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ç–µ–ø–µ—Ä—å –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —è–≤–Ω—ã–π `initialPageParam`, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø:

    ```ts title="initialPageParam" hl_lines="3-4 7"
    const queryInfo = useInfiniteQuery({
      queryKey: ['groups'],
      // ‚úÖ typed correctly as number
      queryFn: ({ pageParam }) =>
        fetchGroups(groups, pageParam),
      getNextPageParam: (lastGroup) => lastGroup.next,
      initialPageParam: 0,
    })
    ```

## –¢–∏–ø–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é {#typing-the-default-query-function}

–Ø –ª–∏—á–Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é [defaultQueryFn](https://tanstack.com/query/latest/docs/framework/react/guides/default-query-function), –Ω–æ —è –∑–Ω–∞—é, —á—Ç–æ –º–Ω–æ–≥–∏–µ –ª—é–¥–∏ —ç—Ç–æ –¥–µ–ª–∞—é—Ç. –≠—Ç–æ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π `queryKey` –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è URL-–∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –≤—ã –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `queryClient`, —Ç–∏–ø –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ `QueryFunctionContext` —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–≤–µ–¥–µ–Ω. TypeScript –ø—Ä–æ—Å—Ç–æ –≥–æ—Ä–∞–∑–¥–æ —É–¥–æ–±–Ω–µ–µ, –∫–æ–≥–¥–∞ –≤—ã –≤—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç–µ –≤–µ—â–∏ :)

```ts title="defaultQueryFn"
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      queryFn: async ({ queryKey: [url] }) => {
        const { data } = await axios.get(`${baseUrl}/${url}`)
        return data
      },
    },
  },
})
```

–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ–¥–Ω–∞–∫–æ —Ç–∏–ø `url` –≤—ã–≤–æ–¥–∏—Ç—Å—è –∫–∞–∫ `unknown`, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤–µ—Å—å `queryKey` - —ç—Ç–æ –º–∞—Å—Å–∏–≤ —Å —Ç–∏–ø–æ–º `unknown`. –ù–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è `queryClient` —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, –∫–∞–∫ –±—É–¥—É—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã `queryKeys` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `useQuery`, –ø–æ—ç—Ç–æ–º—É –∑–¥–µ—Å—å React Query –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –Ω–µ —Ç–∞–∫ —É–∂ –∏ –º–Ω–æ–≥–æ. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—Ä–æ–¥–∞ —ç—Ç–æ–π –∫—Ä–∞–π–Ω–µ –¥–∏–Ω–∞–º–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –≠—Ç–æ –Ω–µ –ø–ª–æ—Ö–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –≤–∞–º –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∑–∞—â–∏—Ç–æ–π –∏ —Å—É–∂–∞—Ç—å —Ç–∏–ø —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∏–º, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```ts title="narrow-with-typeof" hl_lines="5-12"
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      queryFn: async ({ queryKey: [url] }) => {
        // ‚úÖ narrow the type of url to string
        // so that we can work with it
        if (typeof url === 'string') {
          const { data } = await axios.get(
            `${baseUrl}/${url.toLowerCase()}`
          )
          return data
        }
        throw new Error('Invalid QueryKey')
      },
    },
  },
})
```

–î—É–º–∞—é, —ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –ø–æ—á–µ–º—É `unknown` - —ç—Ç–æ —Ç–∞–∫–æ–π –æ—Ç–ª–∏—á–Ω—ã–π (–∏ –Ω–µ–¥–æ–æ—Ü–µ–Ω–µ–Ω–Ω—ã–π) —Ç–∏–ø –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å `any`. –í –ø–æ—Å–ª–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —ç—Ç–æ —Å—Ç–∞–ª–æ –º–æ–∏–º –ª—é–±–∏–º—ã–º —Ç–∏–ø–æ–º - –Ω–æ —ç—Ç–æ —Ç–µ–º–∞ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –±–ª–æ–≥-–ø–æ—Å—Ç–∞. üòä

<small>:material-information-outline: –ò—Å—Ç–æ—á–Ω–∏–∫ &mdash; [https://tkdodo.eu/blog/react-query-and-type-script](https://tkdodo.eu/blog/react-query-and-type-script)</small>
