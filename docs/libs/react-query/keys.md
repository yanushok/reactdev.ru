---
description: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ React Query
---

# –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ React Query

[–ö–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤](https://tanstack.com/query/latest/docs/framework/react/guides/query-keys) - –æ—á–µ–Ω—å –≤–∞–∂–Ω–æ–µ –±–∞–∑–æ–≤–æ–µ –ø–æ–Ω—è—Ç–∏–µ –≤ React Query. –û–Ω–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã, —á—Ç–æ–±—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –º–æ–≥–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –∏—Ö, –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–∞—à–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ù–∞–∫–æ–Ω–µ—Ü, —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –∫–µ—à–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–∏ –∏–ª–∏ –∫–æ–≥–¥–∞ –≤–∞–º –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

–î–∞–≤–∞–π—Ç–µ –±—ã—Å—Ç—Ä–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, —á—Ç–æ –æ–∑–Ω–∞—á–∞—é—Ç —ç—Ç–∏ —Ç—Ä–∏ –∞—Å–ø–µ–∫—Ç–∞, –ø—Ä–µ–∂–¥–µ —á–µ–º –ø–æ–∫–∞–∑–∞—Ç—å –≤–∞–º, –∫–∞–∫ —è –ª–∏—á–Ω–æ –æ—Ä–≥–∞–Ω–∏–∑—É—é –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, —á—Ç–æ–±—ã –±—ã—Ç—å —Å–ø–æ—Å–æ–±–Ω—ã–º –¥–µ–ª–∞—Ç—å —ç—Ç–∏ –≤–µ—â–∏ –±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö {#caching-data}

–í–Ω—É—Ç—Ä–µ–Ω–Ω–µ –ö–µ—à –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—ä–µ–∫—Ç JavaScript, –≥–¥–µ –∫–ª—é—á–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–±–æ–π —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∞ –∑–Ω–∞—á–µ–Ω–∏—è - –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–ª—é—Å –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è. –ö–ª—é—á–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è [–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º](https://tanstack.com/query/latest/docs/framework/react/guides/query-keys#query-keys-are-hashed-deterministically), –ø–æ—ç—Ç–æ–º—É –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã (–æ–¥–Ω–∞–∫–æ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞–º–∏ –∏–ª–∏ –º–∞—Å—Å–∏–≤–∞–º–∏).

–°–∞–º–∞—è –≤–∞–∂–Ω–∞—è —á–∞—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å *—É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏* –¥–ª—è –≤–∞—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ï—Å–ª–∏ React Query –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∑–∞–ø–∏—Å—å –¥–ª—è –∫–ª—é—á–∞ –≤ –∫–µ—à–µ, –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–µ. –¢–∞–∫–∂–µ –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á –¥–ª—è `useQuery` –∏ `useInfiniteQuery`. –í –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ *–æ–¥–∏–Ω* –ö–µ—à –∑–∞–ø—Ä–æ—Å–æ–≤, –∏ –≤—ã –±—ã –ø–æ–¥–µ–ª–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ –¥–≤—É–º—è. –≠—Ç–æ –Ω–µ—Ö–æ—Ä–æ—à–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–º–µ—é—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ —Ä–∞–∑–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å "–æ–±—ã—á–Ω—ã–º–∏" –∑–∞–ø—Ä–æ—Å–∞–º–∏.

```ts
useQuery({
  queryKey: ['todos'],
  queryFn: fetchTodos,
})

// üö® —ç—Ç–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
useInfiniteQuery({
  queryKey: ['todos'],
  queryFn: fetchInfiniteTodos,
})

// ‚úÖ –≤—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ
useInfiniteQuery({
  queryKey: ['infiniteTodos'],
  queryFn: fetchInfiniteTodos,
})
```

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ {#automatic-refetching}

<div style="text-align: center; border-radius: 8px; border: 2px solid #76c2af; color: #76c2af; padding: 10px; font-weight: bold">
  –ó–∞–ø—Ä–æ—Å—ã —è–≤–ª—è—é—Ç—Å—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–º–∏
</div>

–≠—Ç–æ *–æ—á–µ–Ω—å* –≤–∞–∂–Ω–æ–µ –ø–æ–Ω—è—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ–ª—å–∑—è –Ω–µ–¥–æ–æ—Ü–µ–Ω–∏—Ç—å, –∏ —ç—Ç–æ —Ç–∞–∫–∂–µ –Ω–µ—á—Ç–æ, —á—Ç–æ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è "—É—Å–≤–æ–µ–Ω–∏—è". –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ª—é–¥–µ–π –¥—É–º–∞—é—Ç –æ –∑–∞–ø—Ä–æ—Å–∞—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –æ –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å–µ, –≤ *–∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º* –∫–ª—é—á–µ.

–£ –º–µ–Ω—è –µ—Å—Ç—å –∑–∞–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ. –¢–µ–ø–µ—Ä—å —è –Ω–∞–∂–∏–º–∞—é —ç—Ç—É –∫–Ω–æ–ø–∫—É, –∏ —è —Ö–æ—á—É –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å, –Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏. –Ø –≤–∏–¥–µ–ª –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–≥–ª—è–¥—è—Ç —Ç–∞–∫:

```jsx title="imperative-refetch"
function Component() {
  const { data, refetch } = useQuery({
    queryKey: ['todos'],
    queryFn: fetchTodos,
  })

  // ‚ùì –∫–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ ‚ùì
  return <Filters onApply={() => refetch(???)} />
}
```

–û—Ç–≤–µ—Ç: **–í–∞–º –∏ –Ω–µ –Ω—É–∂–Ω–æ.**

–≠—Ç–æ –Ω–µ —Ç–æ, –¥–ª—è —á–µ–≥–æ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –º–µ—Ç–æ–¥ `refetch` - –æ–Ω –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å–∞ *—Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.*

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –∫–∞–∫–æ–µ-—Ç–æ *—Å–æ—Å—Ç–æ—è–Ω–∏–µ*, –∫–æ—Ç–æ—Ä–æ–µ –∏–∑–º–µ–Ω—è–µ—Ç –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –≤—Å–µ, —á—Ç–æ –≤–∞–º –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —ç—Ç–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –µ–≥–æ –≤ –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞, –ø–æ—Ç–æ–º—É —á—Ç–æ React Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å, –∫–æ–≥–¥–∞ –∫–ª—é—á –∏–∑–º–µ–Ω—è–µ—Ç—Å—è. –¢–∞–∫ —á—Ç–æ –∫–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–≤–æ–∏ —Ñ–∏–ª—å—Ç—Ä—ã, –ø—Ä–æ—Å—Ç–æ –∏–∑–º–µ–Ω–∏—Ç–µ *—Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∞—à–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞*:

```jsx title="query-key-drives-the-query"
function Component() {
  const [filters, setFilters] = React.useState()
  const { data } = useQuery({
    queryKey: ['todos', filters],
    queryFn: () => fetchTodos(filters),
  })

  // ‚úÖ –∑–∞–¥–∞–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–æ–∑–≤–æ–ª—å—Ç–µ –µ–º—É —É–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å–æ–º
  return <Filters onApply={setFilters} />
}
```

–ü–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞, –≤—ã–∑–≤–∞–Ω–Ω–∞—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º `setFilters`, –ø–µ—Ä–µ–¥–∞—Å—Ç React Query –¥—Ä—É–≥–æ–π –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞, —á—Ç–æ –∑–∞—Å—Ç–∞–≤–∏—Ç –µ–≥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–∑–∞–ø—Ä–æ—Å. –£ –º–µ–Ω—è –µ—Å—Ç—å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤ —Å—Ç–∞—Ç—å–µ [#1: –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π React Query - –û–±—Ä–∞—â–µ–Ω–∏–µ —Å –∫–ª—é—á–æ–º –∑–∞–ø—Ä–æ—Å–∞ –∫–∞–∫ —Å –º–∞—Å—Å–∏–≤–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π](practical.md#treat-the-query-key-like-a-dependency-array).

## –†—É—á–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ {#manual-interaction}

–†—É—á–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–µ—à–µ–º –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤–∞—à–∏—Ö –∫–ª—é—á–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–º–µ–µ—Ç –Ω–∞–∏–±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ. –ú–Ω–æ–≥–∏–µ –∏–∑ —ç—Ç–∏—Ö –º–µ—Ç–æ–¥–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, —Ç–∞–∫–∏–µ –∫–∞–∫ [invalidateQueries](https://tanstack.com/query/latest/docs/reference/QueryClient#queryclientinvalidatequeries) –∏–ª–∏ [setQueriesData](https://tanstack.com/query/latest/docs/reference/QueryClient#queryclientsetqueriesdata), –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç [—Ñ–∏–ª—å—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤](https://tanstack.com/query/latest/docs/framework/react/guides/filters#query-filters), –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–∞–º –Ω–µ—á–µ—Ç–∫–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª—è—Ç—å –≤–∞—à–∏ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.

## –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ {#effective-react-query-keys}

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —ç—Ç–∏ –º–æ–º–µ–Ω—Ç—ã –æ—Ç—Ä–∞–∂–∞—é—Ç –º–æ–µ –ª–∏—á–Ω–æ–µ –º–Ω–µ–Ω–∏–µ (–∫–∞–∫ –∏ –≤—Å–µ –Ω–∞ —ç—Ç–æ–º –±–ª–æ–≥–µ, —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä—è), –ø–æ—ç—Ç–æ–º—É –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–π—Ç–µ –∏—Ö –∫–∞–∫ –Ω–µ—á—Ç–æ, —á—Ç–æ –≤—ã –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∞—Ç—å –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–ª—é—á–∞–º–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. –Ø –æ–±–Ω–∞—Ä—É–∂–∏–ª, —á—Ç–æ —ç—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –ª—É—á—à–µ –≤—Å–µ–≥–æ —Ä–∞–±–æ—Ç–∞—é—Ç, –∫–æ–≥–¥–∞ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–º, –∏ –æ–Ω–∏ —Ç–∞–∫–∂–µ —Ö–æ—Ä–æ—à–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è. –í–∞–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å —ç—Ç–æ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ —Å–ø–∏—Å–∫–æ–º –¥–µ–ª üòÅ.

### –†–∞–∑–º–µ—â–µ–Ω–∏–µ {#colocate}

–ï—Å–ª–∏ –≤—ã –µ—â–µ –Ω–µ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ —Å—Ç–∞—Ç—å—é [Maintainability through colocation](https://kentcdodds.com/blog/colocation) –æ—Ç [Kent C. Dodds](https://twitter.com/kentcdodds), –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ. –Ø –Ω–µ —Å—á–∏—Ç–∞—é, —á—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–∞—à–∏—Ö –∫–ª—é—á–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –≥–ª–æ–±–∞–ª—å–Ω–æ –≤ `/src/utils/queryKeys.ts` —Å–¥–µ–ª–∞–µ—Ç –≤—Å–µ –ª—É—á—à–µ. –Ø –¥–µ—Ä–∂—É —Å–≤–æ–∏ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Ä—è–¥–æ–º —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏, —Å–æ—Å–µ–¥—Å—Ç–≤—É—é—â–∏–º–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```
- src
  - features
    - Profile
      - index.tsx
      - queries.ts
    - Todos
      - index.tsx
      - queries.ts
```

–§–∞–π–ª *queries* –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å React Query. –û–±—ã—á–Ω–æ —è —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é —Ç–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ö—É–∫–∏, –ø–æ—ç—Ç–æ–º—É —Å–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∞ —Ç–∞–∫–∂–µ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –æ—Å—Ç–∞–Ω—É—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–º–∏.

### –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞—Å—Å–∏–≤—ã –∫–ª—é—á–µ–π {#always-use-array-keys}

–î–∞, –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–∞–∫–∂–µ —Å—Ç—Ä–æ–∫–∞–º–∏, –Ω–æ –¥–ª—è –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏—è —è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∞—Å—Å–∏–≤—ã. React Query –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏—Ö –≤ –º–∞—Å—Å–∏–≤—ã, —Ç–∞–∫ —á—Ç–æ:

```ts title="always-use-array-keys"
// üö® –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–æ –≤ ['todos']
useQuery({ queryKey: 'todos' })
// ‚úÖ
useQuery({ queryKey: ['todos'] })
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –° React Query –≤–µ—Ä—Å–∏–∏ 4 –≤—Å–µ –∫–ª—é—á–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –º–∞—Å—Å–∏–≤–∞–º–∏.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ {#structure}

–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π—Ç–µ –≤–∞—à–∏ –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ *–æ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –æ–±—â–∏—Ö –∫ –Ω–∞–∏–±–æ–ª–µ–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º*, —Å –ª—é–±—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —É—Ä–æ–≤–Ω–µ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–∏–º–∏, –∫–æ—Ç–æ—Ä–æ–µ –≤—ã —Å—á–∏—Ç–∞–µ—Ç–µ –Ω—É–∂–Ω—ã–º. –í–æ—Ç –∫–∞–∫ —è –±—ã —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–ª —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–∫–∏, –∞ —Ç–∞–∫–∂–µ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏:

```js
['todos', 'list', { filters: 'all' }]
['todos', 'list', { filters: 'done' }]
['todos', 'detail', 1]
['todos', 'detail', 2]
```

–° —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π —è –º–æ–≥—É –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –∑–∞–¥–∞—á–∞–º–∏, —Å –ø–æ–º–æ—â—å—é `['todos']`, –≤—Å–µ —Å–ø–∏—Å–∫–∏ –∏–ª–∏ –≤—Å–µ –¥–µ—Ç–∞–ª–∏, –∞ —Ç–∞–∫–∂–µ –Ω–∞—Ü–µ–ª–∏—Ç—å—Å—è –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ø–∏—Å–æ–∫, –µ—Å–ª–∏ —è –∑–Ω–∞—é —Ç–æ—á–Ω—ã–π –∫–ª—é—á. –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –º—É—Ç–∞—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª–µ–µ –≥–∏–±–∫–∏–º–∏ —Å —ç—Ç–∏–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞—Ü–µ–ª–∏—Ç—å—Å—è –Ω–∞ –≤—Å–µ —Å–ø–∏—Å–∫–∏, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:

```js title="updates-from-mutation-responses"
function useUpdateTitle() {
  return useMutation({
    mutationFn: updateTitle,
    onSuccess: (newTodo) => {
      // ‚úÖ –æ–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–µ–ª–∞—Ö
      queryClient.setQueryData(
        ['todos', 'detail', newTodo.id],
        newTodo
      )

      // ‚úÖ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å–ø–∏—Å–∫–∏, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ —ç—Ç–æ –∑–∞–¥–∞–Ω–∏–µ
      queryClient.setQueriesData(['todos', 'list'], (previous) =>
        previous.map((todo) =>
          todo.id === newTodo.id ? newtodo : todo
        )
      )
    },
  })
}
```

–≠—Ç–æ –º–æ–∂–µ—Ç –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ø–∏—Å–∫–æ–≤ –∏ –¥–µ—Ç–∞–ª–µ–π —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è, –ø–æ—ç—Ç–æ–º—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ, –∫–æ–Ω–µ—á–Ω–æ, –ø—Ä–æ—Å—Ç–æ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–ø–∏—Å–∫–∏:

```js title="invalidate-all-lists" hl_lines="10-13"
function useUpdateTitle() {
  return useMutation({
    mutationFn: updateTitle,
    onSuccess: (newTodo) => {
      queryClient.setQueryData(
        ['todos', 'detail', newTodo.id],
        newTodo
      )

      // ‚úÖ –ø—Ä–æ—Å—Ç–æ –∞–Ω–Ω—É–ª–∏—Ä—É–µ—Ç –≤—Å–µ —Å–ø–∏—Å–∫–∏
      queryClient.invalidateQueries({
        queryKey: ['todos', 'list']
      })
    },
  })
}
```

–ï—Å–ª–∏ –≤—ã –∑–Ω–∞–µ—Ç–µ, –Ω–∞ –∫–∞–∫–æ–º —Å–ø–∏—Å–∫–µ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç, –Ω–∞–ø—Ä–∏–º–µ—Ä, —á–∏—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä—ã –∏–∑ URL, –∏ –ø–æ—ç—Ç–æ–º—É –º–æ–∂–µ—Ç–µ —Å–∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω—ã–π –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞, –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —ç—Ç–∏ –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –∏ –≤—ã–∑–≤–∞—Ç—å `setQueryData` –Ω–∞ –≤–∞—à–µ–º —Å–ø–∏—Å–∫–µ –∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ:

```js title="combine" hl_lines="14-28"
function useUpdateTitle() {
  // –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ö—É–∫,
  // –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –≤ url
  const { filters } = useFilterParams()

  return useMutation({
    mutationFn: updateTitle,
    onSuccess: (newTodo) => {
      queryClient.setQueryData(
        ['todos', 'detail', newTodo.id],
        newTodo
      )

      // ‚úÖ –æ–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã —Å–µ–π—á–∞—Å –Ω–∞—Ö–æ–¥–∏–º—Å—è
      queryClient.setQueryData(
        ['todos', 'list', { filters }],
        (previous) =>
          previous.map((todo) =>
            todo.id === newTodo.id ? newtodo : todo
          )
      )

      // ü•≥ –∞–Ω–Ω—É–ª–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å–ø–∏—Å–∫–∏,
      // –Ω–æ –Ω–µ –ø–µ—Ä–µ–≤—ã–±–∏—Ä–∞–π—Ç–µ –∞–∫—Ç–∏–≤–Ω—ã–π.
      queryClient.invalidateQueries({
        queryKey: ['todos', 'list'],
        refetchActive: false,
      })
    },
  })
}
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –í –≤–µ—Ä—Å–∏–∏ 4 `refetchActive` –±—ã–ª –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `refetchType`. –í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ –±—É–¥–µ—Ç `refetchType: 'none'`, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –Ω–∏—á–µ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å.

### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–±—Ä–∏–∫–∏ –∫–ª—é—á–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ {#use-query-key-factories}

–í –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤—ã—à–µ –ø—Ä–∏–º–µ—Ä–∞—Ö –≤—ã –≤–∏–¥–∏—Ç–µ, —á—Ç–æ —è –º–Ω–æ–≥–æ –≤—Ä—É—á–Ω—É—é –æ–±—ä—è–≤–ª—è–ª –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤. –≠—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–æ –æ—à–∏–±–∫–∞–º, –Ω–æ –∏ –¥–µ–ª–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º —Å–ª–æ–∂–Ω–µ–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤—ã –æ–±–Ω–∞—Ä—É–∂–∏—Ç–µ, —á—Ç–æ —Ö–æ—Ç–µ–ª–∏ –±—ã –¥–æ–±–∞–≤–∏—Ç—å –µ—â–µ –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏ –∫ –≤–∞—à–∏–º –∫–ª—é—á–∞–º.

–ü–æ—ç—Ç–æ–º—É —è —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω—É —Ñ–∞–±—Ä–∏–∫—É –∫–ª—é—á–µ–π –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –æ–±—ä–µ–∫—Ç —Å –∑–∞–ø–∏—Å—è–º–∏ –∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∫–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –∑–∞—Ç–µ–º –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –≤–∞—à–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ö—É–∫–∞—Ö. –î–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–π –≤—ã—à–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–∏–º–µ—Ä –º–æ–∂–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:

```ts title="query-key-factory"
const todoKeys = {
  all: ['todos'] as const,
  lists: () => [...todoKeys.all, 'list'] as const,
  list: (filters: string) => [...todoKeys.lists(), { filters }] as const,
  details: () => [...todoKeys.all, 'detail'] as const,
  detail: (id: number) => [...todoKeys.details(), id] as const,
}
```

–≠—Ç–æ –¥–∞–µ—Ç –º–Ω–µ –º–Ω–æ–≥–æ –≥–∏–±–∫–æ—Å—Ç–∏, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–æ–≥–æ, –Ω–æ –≤—Å–µ –∂–µ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º:

```ts title="examples"
// üï∫ —É–¥–∞–ª–∏—Ç–µ –≤—Å–µ, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ñ–∏—á–µ–π todos
queryClient.removeQueries({
  queryKey: todoKeys.all
})

// üöÄ –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å–ø–∏—Å–∫–∏
queryClient.invalidateQueries({
  queryKey: todoKeys.lists()
})

// üôå –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –æ–¥–Ω–æ–≥–æ todo
queryClient.prefetchQueries({
  queryKey: todoKeys.detail(id),
  queryFn: () => fetchTodo(id),
})
```


<small>:material-information-outline: –ò—Å—Ç–æ—á–Ω–∏–∫ &mdash; [https://tkdodo.eu/blog/effective-react-query-keys](https://tkdodo.eu/blog/effective-react-query-keys)</small>
