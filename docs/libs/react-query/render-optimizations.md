---
description: –°—Ç–∞—Ç—å—è –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤ React Query
---

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤ React Query

!!!warning "–î–∏—Å–∫–ª–µ–π–º–µ—Ä"
    –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ ‚Äî —ç—Ç–æ —Å–ª–æ–∂–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –¥–ª—è –ª—é–±–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. React Query —É–∂–µ –ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–∏–º–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –∏ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è. "–õ–∏—à–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Ä–µ–Ω–¥–µ—Ä—ã" ‚Äî —ç—Ç–æ —Ç–µ–º–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –º–Ω–æ–≥–∏–µ –æ–±—ã—á–Ω–æ –∞–∫—Ü–µ–Ω—Ç–∏—Ä—É—é—Ç –≤–Ω–∏–º–∞–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É —è —Ä–µ—à–∏–ª –µ–µ –∑–∞—Ç—Ä–æ–Ω—É—Ç—å. –ù–æ —è —Ö–æ—á—É –µ—â–µ —Ä–∞–∑ –ø–æ–¥—á–µ—Ä–∫–Ω—É—Ç—å, —á—Ç–æ –æ–±—ã—á–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ –∏–º–µ—é—Ç —Ç–∞–∫–æ–≥–æ –±–æ–ª—å—à–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è, –∫–∞–∫ –≤—ã –º–æ–≥–ª–∏ –±—ã –ø–æ–¥—É–º–∞—Ç—å. –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ —Ä–µ–Ω–¥–µ—Ä—ã ‚Äî —ç—Ç–æ —Ö–æ—Ä–æ—à–æ. –û–Ω–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É—é—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –Ø –ø—Ä–µ–¥–ø–æ—á–µ–ª –±—ã "–Ω–µ–Ω—É–∂–Ω—ã–π –ø–æ–≤—Ç–æ—Ä–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä" –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø–µ—Ä–µ–¥ "–ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–º —Ä–µ–Ω–¥–µ—Ä–æ–º, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –±—ã–ª –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω". –î–ª—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ —ç—Ç–æ–π —Ç–µ–º–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å:

    - [Fix the slow render before you fix the re-render](https://kentcdodds.com/blog/fix-the-slow-render-before-you-fix-the-re-render) –æ—Ç Kent C. Dodds
    - [—Å—Ç–∞—Ç—å—è –æ—Ç @ryanflorence –æ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è—Ö](https://reacttraining.com/blog/react-inline-functions-and-performance)

–Ø —É–∂–µ –¥–æ–≤–æ–ª—å–Ω–æ –º–Ω–æ–≥–æ –Ω–∞–ø–∏—Å–∞–ª –æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –æ–ø–∏—Å—ã–≤–∞—è –æ–ø—Ü–∏—é select –≤ [#2: –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ React Query](data-transformations.md). –û–¥–Ω–∞–∫–æ –≤–æ–ø—Ä–æ—Å "–ü–æ—á–µ–º—É React Query –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –º–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–≤–∞ —Ä–∞–∑–∞, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å?" ‚Äî —ç—Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≤–æ–ø—Ä–æ—Å, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –º–Ω–µ –ø—Ä–∏—à–ª–æ—Å—å –æ—Ç–≤–µ—á–∞—Ç—å —á–∞—â–µ –≤—Å–µ–≥–æ (–∫—Ä–æ–º–µ, –≤–æ–∑–º–æ–∂–Ω–æ, –≤–æ–ø—Ä–æ—Å–∞: "–ì–¥–µ —è –º–æ–≥—É –Ω–∞–π—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –¥–ª—è v2" üòÖ). –ü–æ–∑–≤–æ–ª—å—Ç–µ –º–Ω–µ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —Ä–∞–∑—ä—è—Å–Ω–∏—Ç—å —ç—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ.

## –ü–µ—Ä–µ—Ö–æ–¥ isFetching {#isfetching-transition}

[–í –ø—Ä–æ—à–ª–æ–º –ø—Ä–∏–º–µ—Ä–µ](data-transformations.md#3-using-the-select-option) —è –Ω–µ –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–µ—Å—Ç–µ–Ω, –∫–æ–≥–¥–∞ —Å–∫–∞–∑–∞–ª, —á—Ç–æ —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª–∏–Ω—ã —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á:

```jsx title="count-component"
export const useTodosQuery = (select) =>
  useQuery({
    queryKey: ['todos'],
    queryFn: fetchTodos,
    select,
  })
export const useTodosCount = () =>
  useTodosQuery((data) => data.length)

function TodosCount() {
  const todosCount = useTodosCount()

  return <div>{todosCount.data}</div>
}
```

–ö–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è –¥–≤–∞–∂–¥—ã —Å –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–ø—Ä–æ—Å–µ:

```js
{ status: 'success', data: 2, isFetching: true }
{ status: 'success', data: 2, isFetching: false }
```

–≠—Ç–æ –ø–æ—Ç–æ–º—É, —á—Ç–æ React Query –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–Ω–æ–≥–æ –º–µ—Ç–∞–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –∏ —Ñ–ª–∞–≥ `isFetching` ‚Äî –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö. –≠—Ç–æ—Ç —Ñ–ª–∞–≥ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç true, –∫–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –ø–æ–ª–µ–∑–Ω–æ, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏. –ù–æ —ç—Ç–æ —Ç–æ–∂–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º —Ä–æ–¥–µ –∏–∑–ª–∏—à–Ω–µ, –µ—Å–ª–∏ –≤—ã —ç—Ç–æ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç–µ.

### notifyOnChangeProps {#notifyonchangeprops}

–î–ª—è —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞–µ–≤ –≤ React Query –µ—Å—Ç—å –æ–ø—Ü–∏—è `notifyOnChangeProps`. –ï–µ –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–∞–∂–¥–æ–≥–æ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è, —á—Ç–æ–±—ã —Å–æ–æ–±—â–∏—Ç—å React Query: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É–π—Ç–µ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ç–æ–ª—å–∫–æ —ç—Ç–æ—Ç –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å, –µ—Å–ª–∏ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –æ–¥–Ω–æ –∏–∑ —ç—Ç–∏—Ö —Å–≤–æ–π—Å—Ç–≤". –£—Å—Ç–∞–Ω–æ–≤–∏–≤ —ç—Ç—É –æ–ø—Ü–∏—é –Ω–∞ `['data']`, –º—ã –ø–æ–ª—É—á–∏–º –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é, –∫–æ—Ç–æ—Ä—É—é –º—ã –∏—â–µ–º:

```ts title="optimized-with-notifyOnChangeProps" hl_lines="1 6 9"
export const useTodosQuery = (select, notifyOnChangeProps) =>
  useQuery({
    queryKey: ['todos'],
    queryFn: fetchTodos,
    select,
    notifyOnChangeProps,
  })
export const useTodosCount = () =>
  useTodosQuery((data) => data.length, ['data'])
```

–í—ã –º–æ–∂–µ—Ç–µ —É–≤–∏–¥–µ—Ç—å —ç—Ç–æ –≤ –¥–µ–π—Å—Ç–≤–∏–∏ –≤ –ø—Ä–∏–º–µ—Ä–µ [optimistic-updates-typescript](https://github.com/tannerlinsley/react-query/blob/9023b0d1f01567161a8c13da5d8d551a324d6c23/examples/optimistic-updates-typescript/pages/index.tsx#L35-L48) –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.

### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è {#staying-in-sync}

–•–æ—Ç—è –≤—ã—à–µ—É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ–¥ —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –æ–Ω –º–æ–∂–µ—Ç –ª–µ–≥–∫–æ –≤—ã–π—Ç–∏ –∏–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏. –ß—Ç–æ, –µ—Å–ª–∏ –º—ã —Ç–∞–∫–∂–µ —Ö–æ—Ç–∏–º —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ `error`? –ò–ª–∏ –Ω–∞—á–Ω–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥ `isLoading`? –ù–∞–º –Ω—É–∂–Ω–æ –¥–µ—Ä–∂–∞—Ç—å —Å–ø–∏—Å–æ–∫ `notifyOnChangeProps` –≤ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ —Å —Ç–µ–º–∏ –ø–æ–ª—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ –Ω–∞—à–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö. –ï—Å–ª–∏ –º—ã –∑–∞–±—É–¥–µ–º —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å –∏ –±—É–¥–µ–º –Ω–∞–±–ª—é–¥–∞—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞ —Å–≤–æ–π—Å—Ç–≤–æ–º `data`, –∞ –ø–æ–ª—É—á–∏–º –æ—à–∏–±–∫—É, –∫–æ—Ç–æ—Ä—É—é —Ç–∞–∫–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º, –Ω–∞—à –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞–Ω –∏ –±—É–¥–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–º. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º–∞—Ç–∏—á–Ω–æ, –µ—Å–ª–∏ –º—ã –∑–∞—Ö–∞—Ä–¥–∫–æ–¥–∏–º —ç—Ç–æ –≤ –Ω–∞—à–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ö—É–∫–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ö—É–∫ –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –ø–æ–ª—è:

```jsx title="outdated-component"
export const useTodosCount = () =>
  useTodosQuery((data) => data.length, ['data'])

function TodosCount() {
  // üö® –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º error,
  // –Ω–æ –Ω–µ –ø–æ–ª—É—á–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –æ—à–∏–±–∫–∏!
  const { error, data } = useTodosCount()

  return (
    <div>
      {error ? error : null}
      {data ? data : null}
    </div>
  )
}
```

–ö–∞–∫ —è –Ω–∞–º–µ–∫–Ω—É–ª –≤ –¥–∏—Å–∫–ª–µ–π–º–µ—Ä–µ –≤ –Ω–∞—á–∞–ª–µ, —è –¥—É–º–∞—é, —á—Ç–æ —ç—Ç–æ –≥–æ—Ä–∞–∑–¥–æ —Ö—É–∂–µ, —á–µ–º –ª–∏—à–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä. –ö–æ–Ω–µ—á–Ω–æ, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –æ–ø—Ü–∏—é –≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ö—É–∫, –Ω–æ —ç—Ç–æ –≤—Å–µ —Ä–∞–≤–Ω–æ –∫–∞–∂–µ—Ç—Å—è –¥–æ–≤–æ–ª—å–Ω–æ —Ä—É—á–Ω—ã–º —à–∞–±–ª–æ–Ω–æ–º. –ï—Å—Ç—å –ª–∏ —Å–ø–æ—Å–æ–± —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏? –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –µ—Å—Ç—å:

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã {#tracked-queries}

–Ø –≥–æ—Ä–∂—É—Å—å —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –±—ã–ª –º–æ–π –ø–µ—Ä–≤—ã–π –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –≤–∫–ª–∞–¥ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É. –ï—Å–ª–∏ –≤—ã —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `notifyOnChangeProps` –Ω–∞ `'tracked'`, React Query –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞, –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞. –≠—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–Ω–¥–µ—Ä —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –µ—Å–ª–∏ –±—ã –≤—ã —É–∫–∞–∑–∞–ª–∏ —Å–ø–∏—Å–æ–∫ –≤—Ä—É—á–Ω—É—é, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ –æ–± —ç—Ç–æ–º –¥—É–º–∞—Ç—å. –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –≤–∫–ª—é—á–∏—Ç—å —ç—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –≤–∞—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```jsx title="tracked-queries"
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      notifyOnChangeProps: 'tracked',
    },
  },
})
function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <Example />
    </QueryClientProvider>
  )
}
```
–° —ç—Ç–∏–º –≤–∞–º –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–∏–¥–µ—Ç—Å—è –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö —Ä–µ–Ω–¥–µ—Ä–∞—Ö. –ö–æ–Ω–µ—á–Ω–æ, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–∞–∫–∂–µ –∏–º–µ–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã, –ø–æ—ç—Ç–æ–º—É –ø–æ–ª—å–∑—É–π—Ç–µ—Å—å —ç—Ç–∏–º —Ä–∞–∑—É–º–Ω–æ. –ï—Å—Ç—å —Ç–∞–∫–∂–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –ø–æ—ç—Ç–æ–º—É —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –ø–æ –∂–µ–ª–∞–Ω–∏—é:

- –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ [–¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞](https://github.com/tc39/proposal-object-rest-spread/blob/6ee4ce3cdda246746fc46fb149bb8b43c28e704d/Rest.md) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ "object rest", –≤—ã —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–±–ª—é–¥–∞–µ—Ç–µ –∑–∞ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏. –û–±—ã—á–Ω–æ–µ –¥–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ø—É—Å—Ç–∏–º–æ, –ø—Ä–æ—Å—Ç–æ –Ω–µ –¥–µ–ª–∞–π—Ç–µ —Ç–∞–∫:

```ts title="problematic-rest-destructuring"
// üö® –±—É–¥–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –≤—Å–µ–º–∏ –ø–æ–ª—è–º–∏
const { isLoading, ...queryInfo } = useQuery(...)

// ‚úÖ —ç—Ç–æ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ
const { isLoading, data } = useQuery(...)
```
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ "–≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∞". –ï—Å–ª–∏ –≤—ã –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –ø–æ–ª—è–º —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, –æ–Ω–∏ –Ω–µ –±—É–¥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è. –≠—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –∫—Ä–∞–π–Ω–∏–π —Å–ª—É—á–∞–π –∏–∑-–∑–∞ –∏–∑-–∑–∞ –º–∞—Å—Å–∏–≤–æ–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```ts title="tracking-effects"
const queryInfo = useQuery(...)

// üö® –Ω–µ –±—É–¥–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
React.useEffect(() => {
    console.log(queryInfo.data)
})

// ‚úÖ —Ö–æ—Ä–æ—à–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–∞—Å—Å–∏–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–æ—Å—Ç—É–ø–µ–Ω –≤–æ –≤—Ä–µ–º—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
React.useEffect(() => {
    console.log(queryInfo.data)
}, [queryInfo.data])
```

- –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –≤—ã –æ–¥–∏–Ω —Ä–∞–∑ –æ—Ç—Å–ª–µ–¥–∏–ª–∏ –ø–æ–ª–µ, –≤—ã –±—É–¥–µ—Ç–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –µ–≥–æ –≤ —Ç–µ—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—è:

```ts title="no-reset"
const queryInfo = useQuery(...)

if (someCondition()) {
    // üü° –º—ã –±—É–¥–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø–æ–ª–µ –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ someCondition –±—ã–ª–æ –∏—Å—Ç–∏–Ω–Ω—ã–º –≤ –ª—é–±–æ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Ü–∏–∫–ª–µ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞
    return <div>{queryInfo.data}</div>
}
```

!!!danger "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ"
    –ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 4, –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–∫–ª—é—á–µ–Ω—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ React Query, –∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é —Å –ø–æ–º–æ—â—å—é `notifyOnChangeProps: 'all'`.

## –°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ {#structural-sharing}

–î—Ä—É–≥–∞—è, –Ω–æ –Ω–µ –º–µ–Ω–µ–µ –≤–∞–∂–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–µ–Ω–∞ –≤ React Query –∏–∑ –∫–æ—Ä–æ–±–∫–∏, - —ç—Ç–æ _—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ_. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Å—ã–ª–æ—á–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏ –Ω–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —É –≤–∞—Å –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö:

```json
[
  { "id": 1, "name": "Learn React", "status": "active" },
  { "id": 2, "name": "Learn React Query", "status": "todo" }
]
```

–¢–µ–ø–µ—Ä—å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ –º—ã –ø–µ—Ä–µ–≤–æ–¥–∏–º –Ω–∞—à –ø–µ—Ä–≤—ã–π todo –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ done –∏ –≤—ã–ø–æ–ª–Ω—è–µ–º —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ. –ú—ã –ø–æ–ª—É—á–∏–º —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–æ–≤—ã–π JSON —Å –Ω–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

```diff
[
-  { "id": 1, "name": "Learn React", "status": "active" },
+  { "id": 1, "name": "Learn React", "status": "done" },
  { "id": 2, "name": "Learn React Query", "status": "todo" }
]
```

–¢–µ–ø–µ—Ä—å React Query –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–∏—Ç—å —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –Ω–æ–≤–æ–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ –º–∞—Å—Å–∏–≤ todos –±—É–¥–µ—Ç –Ω–æ–≤—ã–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã –æ–±–Ω–æ–≤–∏–ª–∏ todo. –û–±—ä–µ–∫—Ç —Å id 1 —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –Ω–æ–≤—ã–º, –Ω–æ –æ–±—ä–µ–∫—Ç –¥–ª—è id 2 –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç—É –∂–µ —Å—Å—ã–ª–∫—É, —á—Ç–æ –∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏ - React Query –ø—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –µ–≥–æ –≤ –Ω–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –Ω–µ–º –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å.

–≠—Ç–æ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –¥–ª—è —á–∞—Å—Ç–∏—á–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫:

```ts title="optimized-selectors"
// ‚úÖ –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤ —Å–ª—É—á–∞–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è _—á–µ–≥–æ-—Ç–æ_ –≤–Ω—É—Ç—Ä–∏ todo —Å id:2
// –±–ª–∞–≥–æ–¥–∞—Ä—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–º—É —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—é
const { data } = useTodo(2)
```

–ö–∞–∫ —è —É–∂–µ –Ω–∞–º–µ–∫–∞–ª —Ä–∞–Ω–µ–µ, –¥–ª—è —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–≤–∞–∂–¥—ã: —Å–Ω–∞—á–∞–ª–∞ –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∏–∑ `queryFn`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –ø—Ä–æ–∏–∑–æ—à–ª–∏ –ª–∏ –≤–æ–æ–±—â–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∞ –∑–∞—Ç–µ–º –µ—â–µ —Ä–∞–∑ –¥–ª—è _—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞_ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ _–º–æ–∂–µ—Ç_ —Å—Ç–∞—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –¥–∞–Ω–Ω—ã–º–∏, —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º—ã–º–∏ –≤ JSON. –ï—Å–ª–∏ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–∞ —ç—Ç–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª—é—á–∏—Ç—å –µ–µ, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ `structuralSharing: false` –¥–ª—è –ª—é–±–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ [—Ç–µ—Å—Ç—ã replaceEqualDeep](https://github.com/tannerlinsley/react-query/blob/80cecef22c3e088d6cd9f8fbc5cd9e2c0aab962f/src/core/tests/utils.test.tsx#L97-L304), –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º.

<small>:material-information-outline: –ò—Å—Ç–æ—á–Ω–∏–∫ &mdash; [https://tkdodo.eu/blog/react-query-render-optimizations](https://tkdodo.eu/blog/react-query-render-optimizations)</small>
