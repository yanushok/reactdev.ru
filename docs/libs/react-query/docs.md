# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**React Query** - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è "—Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ" —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö.

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
yarn add react-query
# –∏–ª–∏
npm i react-query
```

## –ü—Ä–∏–º–µ—Ä

```js
import {
  QueryClient,
  QueryClientProvider,
  useQuery,
} from 'react-query';

const queryClient = new QueryClient();

export const App = () => (
  <QueryClientProvider>
    <Example />
  </QueryClientProvider>
);

function Example() {
  const { isLoading, error, data } = useQuery(
    'repoData',
    () =>
      fetch(
        'https://api.github.com/repos/tannerlinsley/react-query'
      ).then((response) => response.json())
  );

  if (isLoading) return <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>;

  if (error) return <p>–û—à–∏–±–∫–∞: {error.message}</p>;

  return (
    <div>
      <h1>{data.name}</h1>
      <p>{data.description}</p>
      <strong>üëÄ {data.subscribers_count}</strong>{' '}
      <strong>‚ú® {data.stargazers_count}</strong>{' '}
      <strong>üç¥ {data.forks_count}</strong>
    </div>
  );
}
```

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ö–ª—é—á–µ–≤—ã–º–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏ `React Query` —è–≤–ª—è—é—Ç—Å—è:

- –ó–∞–ø—Ä–æ—Å—ã (queries)
- –ú—É—Ç–∞—Ü–∏–∏ (mutations)
- –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è (–∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º) –∑–∞–ø—Ä–æ—Å–∞ (query invalidation), –µ–≥–æ –∫—ç—à–∞

```js
import {
  useQuery,
  useMutation,
  useQueryClient,
  QueryClient,
  QueryClientProvider,
} from 'react-query';

import { getTodos, postTodo } from '../api';

// –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞
const queryClient = new QueryClient();

const App = () => (
  // –ü–µ—Ä–µ–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
  <QueryClientProvider client={queryClient}>
    <Todos />
  </QueryClientProvider>
);

function Todos() {
  // –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–ª–∏–µ–Ω—Ç—É
  const queryClient = useQueryClient();

  // –ó–∞–ø—Ä–æ—Å
  const query = useQuery('todos', getTodos);

  // –ú—É—Ç–∞—Ü–∏—è
  const mutation = useMutation(postTodo, {
    onSuccess: () => {
      // –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
      queryClient.invalidateQueries('todos');
    },
  });

  return (
    <div>
      <ul>
        {query.data.map((todo) => (
          <li key={todo.id}>{todo.title}</li>
        ))}
      </ul>

      <button
        onClick={() => {
          mutation.mutate({
            id: Date.now(),
            title: '–ü—Ä–∏–≤–µ—Ç',
          });
        }}
      >
        –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É
      </button>
    </div>
  );
}

render(<App />, document.getElementById('root'));
```

## –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –Ω–µ –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—É—é —Å–±–æ—Ä–∫—É (–∫–æ–≥–¥–∞ `process.env.NODE_ENV === 'production'`).

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –ø–ª–∞–≤–∞—é—â–∏–π (floating) –∏ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π (inline).

### –ü–ª–∞–≤–∞—é—â–∏–π —Ä–µ–∂–∏–º

```js
import { ReactQueryDevtools } from 'react-query/devtools';

const App = () => (
  <QueryClientProvider client={queryClient}>
    {/* –î—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã */}
    <ReactQueryDevtools initialIsOpen={false} />
  </QueryClientProvider>
);
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- `initialIsOpen` - –µ—Å–ª–∏ `true`, —Ç–æ –ø–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –±—É–¥–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∞
- `panelProps` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø–æ–≤ –∫ –ø–∞–Ω–µ–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, `className`, `style` –∏ —Ç.–¥.
- `closeButtonProps` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø–æ–≤ –∫ –∫–Ω–æ–ø–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏
- `toggleButtonProps` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø–æ–≤ –∫ –∫–Ω–æ–ø–∫–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- `position`: "top-left" | "top-right" | "bottom-left" | "bottom-right" - –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ª–æ–≥–æ—Ç–∏–ø–∞ `React Query` –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø–∞–Ω–µ–ª–∏

### –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º

```js
import { ReactQueryDevtoolsPanel } from 'react-query/devtools';

const App = () => (
  <QueryClientProvider client={queryClient}>
    {/* –î—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã */}
    <ReactQueryDevtoolsPanel
      style={styles}
      className={className}
    />
  </QueryClientProvider>
);
```

## –í–∞–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

- –≠–∫–∑–µ–º–ø–ª—è—Ä—ã –∑–∞–ø—Ä–æ—Å–∞(query instances), —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é `useQuery` –∏–ª–∏ `useInfiniteQuery` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—á–∏—Ç–∞—é—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ (stale)
- –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (background) –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:
  - –ú–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∑–∞–ø—Ä–æ—Å–∞
  - –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –æ–∫–Ω–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
  - –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ç–∏
  - –ö–æ–≥–¥–∞ –∑–∞–¥–∞–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (refetch interval)
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–∞, –Ω–µ –∏–º–µ—é—â–∏–µ –∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ `useQuery`, `useInfiniteQuery` –∏–ª–∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª–µ–π (observers) –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ "–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ" (inactive) –∏ –æ—Å—Ç–∞—é—Ç—Å—è –≤ –∫—ç—à–µ
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–ø—Ä–æ—Å—ã, –ø–æ–º–µ—á–µ–Ω–Ω—ã–µ –∫–∞–∫ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ, —É–Ω–∏—á—Ç–æ–∂–∞—é—Ç—Å—è —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç
- –ü—Ä–æ–≤–∞–ª–∏–≤—à–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è 3 —Ä–∞–∑–∞ —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–π—Å—è –∑–∞–¥–µ—Ä–∂–∫–æ–π –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π –æ—à–∏–±–∫–∏ –≤ UI
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≥–æ, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å, –∏ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ —Ç–∞–∫, —Å—Å—ã–ª–∫–∞ –Ω–∞ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω–æ–π, —á—Ç–æ —Å–ø–æ—Å–æ–±—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `useMemo` –∏ `useCallback`

## –ó–∞–ø—Ä–æ—Å—ã

### –û—Å–Ω–æ–≤—ã

–ó–∞–ø—Ä–æ—Å - —ç—Ç–æ –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö, —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–ª—é—á–æ–º. –ó–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å –ª—é–±—ã–º –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–º –Ω–∞ –ø—Ä–æ–º–∏—Å–µ –º–µ—Ç–æ–¥–æ–º (–≤–∫–ª—é—á–∞—è –º–µ—Ç–æ–¥—ã `GET` –∏ `POST`) –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞. –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, —Ç–æ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º—É—Ç–∞—Ü–∏–∏.

–î–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∑–∞–ø—Ä–æ—Å –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–º —Ö—É–∫–µ —Å–ª–µ–¥—É–µ—Ç –≤—ã–∑–≤–∞—Ç—å —Ö—É–∫ `useQuery` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞
- –§—É–Ω–∫—Ü–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –ø—Ä–æ–º–∏—Å, –∫–æ—Ç–æ—Ä—ã–π
  - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ (resolve data) –∏–ª–∏
  - –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ (throw error)

```js
import { useQuery } from 'react-query';

function App() {
  const info = useQuery('todos', fetchTodoList);
}
```

–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–∞, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ `useQuery`, —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å—é –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–ø—Ä–æ—Å–µ.

```js
const result = useQuery('todos', fetchTodos);
```

–û–±—ä–µ–∫—Ç `result` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞–∂–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π (states). –ó–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:

- `isLoading` –∏–ª–∏ `status === 'loading'` - –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –¥–∞–Ω–Ω—ã–µ –µ—â–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã
- `isError` –∏–ª–∏ `status === 'error'` - –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è –æ—à–∏–±–∫–æ–π
- `isSuccess` –∏–ª–∏ `status === 'success'` - –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ, –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã
- `isIdle` –∏–ª–∏ `status === 'idle'` - –∑–∞–ø—Ä–æ—Å –æ—Ç–∫–ª—é—á–µ–Ω

–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –æ–±—ä–µ–∫—Ç `result` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–µ–¥—É—é—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:

- `error` - –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `isError`, –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `error`
- `data` - –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `success`, –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `data`
- `isFetching` - –≤ –ª—é–±–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è —Ñ–æ–Ω–æ–≤—ã–π –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å) `isFetching` –±—É–¥–µ—Ç –∏–º–µ—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `true`

–î–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ `isLoading`, –∑–∞—Ç–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ `isError` –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:

```js
function Todos() {
  const { isLoading, isError, data, error } = useQuery(
    'todos',
    fetchTodoList
  );

  if (isLoading) {
    return <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>;
  }

  if (isError) {
    return <span>–û—à–∏–±–∫–∞: {error.message}</span>;
  }

  // –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç—å, —á—Ç–æ `isSuccess === true`
  return (
    <ul>
      {data.map((todo) => (
        <li key={todo.id}>{todo.title}</li>
      ))}
    </ul>
  );
}
```

–í–º–µ—Å—Ç–æ –ª–æ–≥–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ `status`:

```js
function Todos() {
  const { status, data, error } = useQuery(
    'todos',
    fetchTodoList
  );

  if (status === 'loading') {
    return <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>;
  }

  if (status === 'error') {
    return <span>–û—à–∏–±–∫–∞: {error.message}</span>;
  }

  // status === 'success'
  return (
    <ul>
      {data.map((todo) => (
        <li key={todo.id}>{todo.title}</li>
      ))}
    </ul>
  );
}
```

### –ö–ª—é—á–∏ –∑–∞–ø—Ä–æ—Å–∞

`React Query` –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–π. –ö–ª—é—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ª—é–±—ã–º–∏ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (—Å—Ç—Ä–æ–∫–∞–º–∏, –º–∞—Å—Å–∏–≤–∞–º–∏, –æ–±—ä–µ–∫—Ç–∞–º–∏ –∏ —Ç.–¥.).

#### –°—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–ª—é—á–∏

–ü—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–∏ —Å—Ç—Ä–æ–∫–∏ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞ –∑–∞–ø—Ä–æ—Å–∞, –æ–Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤ —Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º. –î–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è:

- –û–±—â–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Å–ø–∏—Å–∫–∞/–∏–Ω–¥–µ–∫—Å–∞
- –ù–µ–∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

```js
// –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
useQuery('todos', ...) // queryKey === ['todos']
```

#### –ö–ª—é—á–∏ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞

–ö–æ–≥–¥–∞ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–ª—é—á–∞ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –º–∞—Å—Å–∏–≤ —Å–æ —Å—Ç—Ä–æ–∫–æ–π –∏ –ª—é–±—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤. –¢–∞–∫–æ–π —Ñ–æ—Ä–º–∞—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è:

- –ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö –∏–ª–∏ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
  - –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –æ–±—ã—á–Ω–æ, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –∏–Ω–¥–µ–∫—Å –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–∏–º–∏—Ç–∏–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞
- –ó–∞–ø—Ä–æ—Å–æ–≤ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  - –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

```js
// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞
useQuery(['todo', 5], ...)
// queryKey === ['todo', 5]

// –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –∑–∞–¥–∞—á–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–ø—Ä–µ–≤—å—é"
useQuery(['todo', 5, { preview: true }], ...)
// queryKey === ['todo', 5, { preview: true }]

// –°–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
useQuery(['todos', { type: 'done' }], ...)
// queryKey === ['todos', { type: 'done' }]
```

#### –ö–ª—é—á–∏ —Ö–µ—à–∏—Ä—É—é—Ç—Å—è –¥–µ—Ç–µ—Ä–º–µ–Ω–∏—Ä–æ–≤–∞–Ω–æ

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ—Ä—è–¥–æ–∫ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–ª—é—á–µ–π –≤ –æ–±—ä–µ–∫—Ç–µ –Ω–µ –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è:

```js
// –≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
useQuery(['todos', { status, page }], ...)
useQuery(['todos', { page, status }], ...)
useQuery(['todos', { page, status, other: undefined }], ...)
```

–ê –ø–æ—Ä—è–¥–æ–∫ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è –∫–ª—é—á–µ–π –≤ –º–∞—Å—Å–∏–≤–µ, –Ω–∞–ø—Ä–æ—Ç–∏–≤, –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ:

```js
// –≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã
useQuery(['todos', status, page], ...)
useQuery(['todos', page, status], ...)
useQuery(['todos', undefined, page, status], ...)
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_, —á—Ç–æ –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, —Ç–∞–∫–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–æ–ª–∂–Ω–∞ –≤–∫–ª—é—á–∞—Ç—å—Å—è –≤ –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞:

```js
function Todos({ todoId }) {
  const result = useQuery(['todos', todoId], () =>
    fetchTodoById(todoId)
  );
}
```

### –§—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞

–§—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–µ–π –ø—Ä–æ–º–∏—Å, –∫–æ—Ç–æ—Ä—ã–π, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, –¥–æ–ª–∂–µ–Ω –ª–∏–±–æ —Ä–∞–∑—Ä–µ—à–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–º–∏, –ª–∏–±–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ:

```js
useQuery(['todos', todoId], fetchTodoById);
useQuery(['todos', todoId], () => fetchTodoById(todoId));
useQuery(['todos', todoId], async () => {
  const data = await fetchTodoById(todoId);
  return data;
});
```

#### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏, —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `error` –∑–∞–ø—Ä–æ—Å–∞:

```js
const { data, error } = useQuery(
  ['todos', todoId],
  async () => {
    const response = await fetch('/todos/' + todoId);

    if (!response.ok) {
      throw new Error('–ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫');
    }

    return await response.json();
  }
);
```

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º, —É–∫–∞–∑–∞–Ω–Ω—ã–º –≤ –∫–ª—é—á–µ –∑–∞–ø—Ä–æ—Å–∞:

```js
function Todos({ status, page }) {
  const result = useQuery(
    ['todos', { status, page }],
    fetchTodoList
  );
}

// –ü–æ–ª—É—á–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `key`, `status` –∏ `page` –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞
function fetchTodoList({ queryKey }) {
  const [_key, { status, page }] = queryKey;
  return new Promise();
}
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–î–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç:

```js
import { useQuery } from 'react-query';

useQuery({
  queryKey: ['todo', 5],
  queryFn: fetchTodo,
  ...config,
});
```

### –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

"–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏" –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –∑–∞–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

–ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º, –¥–ª—è –∏—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ö—É–∫–æ–≤ `useQuery` –∏–ª–∏ `useInfiniteQuery`:

```js
function App () {
  // –≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
  const usersQuery = useQuery('users', fetchUsers)
  const teamsQuery = useQuery('teams', fetchTeams)
  const projectsQuery = useQuery('projects', fetchProjects)
  ...
}
```

–ö–æ–≥–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–Ω—è–µ—Ç—Å—è –æ—Ç —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∫ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥—É, –¥–ª—è –∏—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—É–∫ `useQueries`. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤:

```js
function App({ users }) {
  const userQueries = useQueries(
    users.map((user) => ({
      queryKey: ['user', user.id],
      queryFn: () => fetchUserById(user.id),
    }))
  );
}
```

### –ó–∞–≤–∏—Å–∏–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–ù–∞—á–∞–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º—ã—Ö (–∏–ª–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö) –∑–∞–ø—Ä–æ—Å–æ–≤ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–∫–æ–Ω—á–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `enabled`:

```js
// –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const { data: user } = useQuery(
  ['user', email],
  getUserByEmail
);

const userId = user?.id;

// –ó–∞—Ç–µ–º –ø–æ–ª—É—á–∞–µ–º –ø—Ä–æ–µ–∫—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
const { isIdle, data: projects } = useQuery(
  ['projects', userId],
  getProjectsByUser,
  {
    // –ó–∞–ø—Ä–æ—Å –Ω–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è userId
    enabled: !!userId,
  }
);
```

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

–í –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–æ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è `status === 'loading'`. –ù–æ –∏–Ω–æ–≥–¥–∞ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞, –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –î–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `isFetching`:

```js
function Todos() {
  const {
    status,
    data: todos,
    error,
    isFetching,
  } = useQuery('todos', fetchTodos);

  return status === 'loading' ? (
    <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
  ) : status === 'error' ? (
    <span>–û—à–∏–±–∫–∞: {error.message}</span>
  ) : (
    <>
      {isFetching ? <p>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...</p> : null}

      <div>
        {todos.map((todo) => (
          <Todo todo={todo} />
        ))}
      </div>
    </>
  );
}
```

–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –ª—é–±–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–≤ —Ç–æ–º —á–∏—Å–ª–µ, –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ö—É–∫ `useIsFetching`:

```js
import { useIsFetching } from 'react-query';

function GlobalLoadingIndicator() {
  const isFetching = useIsFetching();

  return isFetching ? (
    <p>–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ...</p>
  ) : null;
}
```

### –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–∏ —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–µ –Ω–∞ –æ–∫–Ω–µ

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–∫–∏–¥–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–º –¥–∞–Ω–Ω—ã–º, `React Query` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω–æ –∏–ª–∏ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `refetchOnWindowFocus`.

–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ:

```js
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      refetchOnWindowFocus: false,
    },
  },
});

function App() {
  return (
    <QueryClientProvider client={queryClient}>
      ...
    </QueryClientProvider>
  );
}
```

–û—Ç–∫–ª—é—á–µ–Ω–∏–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞:

```js
useQuery('todos', fetchTodos, {
  refetchOnWindowFocus: false,
});
```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ/–ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

–î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `enabled`.

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `false`:

- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
  - –ó–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `status === 'success'` –∏–ª–∏ `isSuccess`
- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ –∏–º–µ–µ—Ç —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
  - –ó–∞–ø—Ä–æ—Å –±—É–µ—Ç –∑–∞–ø—É—â–µ–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `status === 'idle'` –∏–ª–∏ `isIdle`
- –ó–∞–ø—Ä–æ—Å –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ó–∞–ø—Ä–æ—Å –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏–ª–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞
- –ó–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã `invalidateQueries` –∏ `refetchQueries` –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –∑–∞–ø—Ä–æ—Å–∞ (query client), –æ–±—ã—á–Ω–æ, –ø—Ä–∏–≤–æ–¥—è—â–∏–µ –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –î–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `refetch`

```js
function Todos() {
  const {
    isIdle,
    isLoading,
    isError,
    data,
    error,
    refetch,
    isFetching,
  } = useQuery('todos', fetchTodoList, {
    enabled: false,
  });

  return (
    <>
      <button onClick={() => refetch()}>
        –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏
      </button>

      {isIdle ? (
        <span>–ù–µ –≥–æ—Ç–æ–≤...</span>
      ) : isLoading ? (
        <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
      ) : isError ? (
        <span>–û—à–∏–±–∫–∞: {error.message}</span>
      ) : (
        <>
          <ul>
            {data.map((todo) => (
              <li key={todo.id}>{todo.title}</li>
            ))}
          </ul>
          <div>
            {isFetching ? '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞...' : null}
          </div>
        </>
      )}
    </>
  );
}
```

### –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–ª–∏–≤—à–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤

–ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –∑–∞–ø—Ä–æ—Å–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è 3 –ø–æ–ø—ã—Ç–∫–∏ –µ–≥–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

–≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞–∫ –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ, —Ç–∞–∫ –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `retry: false` –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—ã
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `retry: 6` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–æ 6
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `retry: true` –¥–µ–ª–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä—ã –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏
- –£—Å—Ç–∞–Ω–æ–∫–∞ `retry: (failureCount, error) => {}` –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–æ–≤–∞–ª–∞

```js
import { useQuery } from 'react-query';

// –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
const result = useQuery(['todos', 1], fetchTodoListPage, {
  retry: 10, // –ü–µ—Ä–µ–¥ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ—à–∏–±–∫–∏ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–æ 10 –ø–æ–ø—ã—Ç–æ–∫
});
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –ø–æ–≤—Ç–æ—Ä–∞–º–∏ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç 2000, 4000 –∏ 6000 –º—Å. –≠—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `retryDelay`.

### –ó–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `React Query` –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞:

```js
const result = useQuery(['projects', page], fetchProjects);
```

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –µ—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä, —Ç–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—Å—è, —á—Ç–æ UI –ø–µ—Ä–µ–ø—Ä—ã–≥–∏–≤–∞–µ—Ç –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ `success` –∏ `loading`, –ø–æ—Å–∫–æ–ª—å–∫—É –∫–∞–∂–¥–∞—è –Ω–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞—Å—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è –∫–∞–∫ –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã `React Query` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `keepPreviousData`. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `true` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É:

- –î–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –æ—Å—Ç–∞—é—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä—ã–µ `data` –º—è–≥–∫–æ –∏–º–∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è
- `isPreviousData` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Ç–µ–∫—É—â–∏–º –∑–∞–ø—Ä–æ—Å–æ–º

```js
function Todos() {
  const [page, setPage] = React.useState(0);

  const fetchProjects = (page = 0) =>
    fetch('/api/projects?page=' + page);

  const {
    isLoading,
    isError,
    error,
    data,
    isFetching,
    isPreviousData,
  } = useQuery(
    ['projects', page],
    () => fetchProjects(page),
    { keepPreviousData: true }
  );

  return (
    <div>
      {isLoading ? (
        <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
      ) : isError ? (
        <span>–û—à–∏–±–∫–∞: {error.message}</span>
      ) : (
        <div>
          {data.projects.map((project) => (
            <p key={project.id}>{project.name}</p>
          ))}
        </div>
      )}
      <span>–¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: {page + 1}</span>
      <button
        onClick={() =>
          setPage((old) => Math.max(old - 1, 0))
        }
        disabled={page === 0}
      >
        –ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
      </button>{' '}
      <button
        onClick={() => {
          if (!isPreviousData && data.hasMore) {
            setPage((old) => old + 1);
          }
        }}
        // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É, –ø–æ–∫–∞ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π
        disabled={isPreviousData || !data.hasMore}
      >
        –°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
      </button>
      {isFetching ? <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span> : null}{' '}
    </div>
  );
}
```

`keepPreviousData` —Ç–∞–∫–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ö—É–∫–æ–º `useInfiniteQuery`, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª—é—á–µ–π –∑–∞–ø—Ä–æ—Å–∞.

### –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–î–ª—è –∑–∞–ø—Ä–æ—Å–∞ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–∑–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ" –∏–ª–∏ "–±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞") `React Query` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é `useQuery` - `useInfiniteQuery`.

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `useInfiniteQuery`:

- `data` - –æ–±—ä–µ–∫—Ç, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
  - `data.pages` - –º–∞—Å—Å–∏–≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
  - `data.pageParams` - –º–∞—Å—Å–∏–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
- –î–æ—Å—Ç—É–ø–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `fetchNextPage` –∏ `fetchPreviousPage`
- –î–æ—Å—Ç—É–ø–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `getNextPageParam` –∏ `getPreviousPageParam`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- –î–æ—Å—Ç—É–ø–Ω–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `hasNextPage`. –ï—Å–ª–∏ –æ–Ω–æ —Ä–∞–≤–Ω—è–µ—Ç—Å—è `true`, `getNextPageParam` –≤–µ—Ä–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –Ω–µ `undefined`
- –î–æ—Å—Ç—É–ø–Ω–æ –ª–æ–≥–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `hasPreviousPage`. –ï—Å–ª–∏ –æ–Ω–æ —Ä–∞–≤–Ω—è–µ—Ç—Å—è `true`, `getPreviousPageParam` –≤–µ—Ä–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –Ω–µ `undefined`
- –î–æ—Å—Ç—É–ø–Ω—ã –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `isFetchingNextPage` –∏ `isFetchingPreviousPage`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ —Ä–∞–∑–ª–∏—á–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–æ–Ω–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏

#### –ü—Ä–∏–º–µ—Ä—ã

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –∏–º–µ–µ—Ç—Å—è API, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —Ç—Ä–µ–º—è `projects` –∑–∞ —Ä–∞–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–µ–∫—Å–∞ `cursor`, –∞ —Ç–∞–∫–∂–µ —Å–∞–º –∫—É—Ä—Å–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–π –≥—Ä—É–ø–ø—ã –ø—Ä–æ–µ–∫—Ç–æ–≤:

```js
fetch('/api/projects?cursor=0');
// { data: [...], nextCursor: 3}
fetch('/api/projects?cursor=3');
// { data: [...], nextCursor: 6}
fetch('/api/projects?cursor=6');
// { data: [...], nextCursor: 9}
fetch('/api/projects?cursor=9');
// { data: [...] }
```

–†–∞—Å–ø–æ–ª–∞–≥–∞—è —ç—Ç–∏–º–∏ —Å–≤–µ–¥–µ–Ω–∏—è–º–∏, –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å UI "–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ" –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º:

- –û–∂–∏–¥–∞–Ω–∏—è, –ø–æ–∫–∞ `useInfiniteQuery` –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –ø–æ—Ä—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤ `getNextPageParam`
- –í—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `fetchNextPage`

```js
import { useInfiniteQuery } from 'react-query';

function Projects() {
  const fetchProjects = ({ pageParam = 0 }) =>
    fetch('/api/projects?cursor=' + pageParam);

  const {
    data,
    error,
    fetchNextPage,
    hasNextPage,
    isFetching,
    isFetchingNextPage,
    status,
  } = useInfiniteQuery('projects', fetchProjects, {
    getNextPageParam: (lastPage, pages) =>
      lastPage.nextCursor,
  });

  return status === 'loading' ? (
    <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
  ) : status === 'error' ? (
    <p>–û—à–∏–±–∫–∞: {error.message}</p>
  ) : (
    <>
      {data.pages.map((group, i) => (
        <React.Fragment key={i}>
          {group.projects.map((project) => (
            <p key={project.id}>{project.name}</p>
          ))}
        </React.Fragment>
      ))}
      <div>
        <button
          onClick={() => fetchNextPage()}
          disabled={!hasNextPage || isFetchingNextPage}
        >
          {isFetchingNextPage
            ? '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...'
            : hasNextPage
            ? '–ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â–µ'
            : '–ë–æ–ª—å—à–µ –Ω–µ—á–µ–≥–æ –∑–∞–≥—Ä—É–∂–∞—Ç—å'}
        </button>
      </div>
      <div>
        {isFetching && !isFetchingNextPage
          ? '–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞...'
          : null}
      </div>
    </>
  );
}
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–∞—è –∏–∑ `getNextPageParam`, –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è, –ø–µ—Ä–µ–¥–∞–Ω–Ω–∞—è –≤ `fetchNextPage`, –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –¥–µ—Ñ–æ–ª—Ç–Ω—É—é:

```js
function Projects() {
  const fetchProjects = ({ pageParam = 0 }) =>
    fetch('/api/projects?cursor=' + pageParam);

  const {
    status,
    data,
    isFetching,
    isFetchingNextPage,
    fetchNextPage,
    hasNextPage,
  } = useInfiniteQuery('projects', fetchProjects, {
    getNextPageParam: (lastPage, pages) =>
      lastPage.nextCursor,
  });

  // –ü–µ—Ä–µ–¥–∞–µ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  const skipToCursor50 = () =>
    fetchNextPage({ pageParam: 50 });
}
```

–î–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é `getPreviousPageParam`, `fetchPreviousPage`, `hasPreviousPage` –∏ `isFetchingPreviousPage`:

```js
useInfiniteQuery('projects', fetchProjects, {
  getNextPageParam: (lastPage, pages) =>
    lastPage.nextCursor,
  getPreviousPageParam: (firstPage, pages) =>
    firstPage.prevCursor,
});
```

–†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```js
queryClient.setQueryData('projects', (data) => ({
  pages: data.pages.slice(1),
  pageParams: data.pageParams.slice(1),
}));
```

–†—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã:

```js
const newPagesArray = [];
oldPagesArray?.pages.forEach((page) => {
  const newData = page.data.filter(
    (val) => val.id !== updatedId
  );
  newPagesArray.push({
    data: newData,
    pageParam: page.pageParam,
  });
});
queryClient.setQueryData('projects', (data) => ({
  pages: newPagesArray,
  pageParams: data.pageParams,
}));
```

### –ó–∞–º–µ–Ω–∏—Ç–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞

–î–∞–Ω–Ω—ã–µ-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏ (placeholder data) –ø–æ–∑–≤–æ–ª—è—é—Ç –∑–∞–ø—Ä–æ—Å–∞–º —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω—ã–π ("—Ñ–µ–π–∫–æ–≤—ã–π") –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –≠—Ç–æ –¥–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –ø–æ—Ö–æ–∂–∏–π –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `initialData`, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∫—ç—à–µ.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø–æ–º–µ—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –∫—ç—à –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–º–µ–Ω–∏—Ç–µ–ª–µ–π:

- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π:
  - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—É `placeholderData` –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—É—Å—Ç–æ–≥–æ –∫—ç—à–∞
- –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π:
  - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –∏–ª–∏ –æ–±—ã—á–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `queryClient` –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `placeholderData`

#### –î–∞–Ω–Ω—ã–µ-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ

```js
function Todos() {
  const result = useQuery('todos', () => fetch('/todos'), {
    placeholderData: placeholderTodos,
  });
}
```

#### –î–∞–Ω–Ω—ã–µ-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏—è

–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–µ–π —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–º –∏–ª–∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –æ–Ω –ø–æ–≤—Ç–æ—Ä—è–ª—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ, —Ç–æ–≥–¥–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è `placeholderData` –º–æ–∂–Ω–æ –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–¥–∞—Ç—å –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:

```js
function Todos() {
  const placeholderData = useMemo(
    () => generateFakeTodos(),
    []
  );
  const result = useQuery('todos', () => fetch('/todos'), {
    placeholderData,
  });
}
```

#### –î–∞–Ω–Ω—ã–µ-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏ –∏–∑ –∫—ç—à–∞

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–µ–π –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥—Ä—É–≥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –•–æ—Ä–æ—à–∏–º –ø—Ä–∏–º–µ—Ä–æ–º —Ç–∞–∫–æ–≥–æ —Å–ª—É—á–∞—è —è–≤–ª—è–µ—Ç—Å—è –ø–æ–∏—Å–∫ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ—Å—Ç–∞ –≤ –±–ª–æ–≥–µ –¥–ª—è –ø—Ä–µ–≤—å—é –ø–æ—Å—Ç–∞ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–∞–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–º–µ–Ω–∏—Ç–µ–ª—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞:

```js
function Todo({ blogPostId }) {
  const result = useQuery(
    ['blogPost', blogPostId],
    () => fetch('/blogPosts'),
    {
      placeholderData: () => {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ–≤—å—é blogPost –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ 'blogPosts'
        // –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–º–µ–Ω–∏—Ç–µ–ª—è –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–≥–æ blogPost
        return queryClient
          .getQueryData('blogPosts')
          ?.find((d) => d.id === blogPostId);
      },
    }
  );
}
```

### –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∞

–°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –ø–æ–º–µ—â–µ–Ω–∏—è –≤ –∫—ç—à –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞:

- –î–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω—ã–π
  - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—É `initialData` –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—É—Å—Ç–æ–≥–æ –∫—ç—à–∞
- –ò–º–ø–µ—Ä–∞—Ç–∏–≤–Ω—ã–π
  - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `queryClient.prefetchQuery`
  - –†—É—á–Ω–æ–µ –ø–æ–º–µ—â–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∫—ç—à —Å –ø–æ–º–æ—â—å—é `queryClient.setQueryData`

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `initialData` –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞

–ï—Å–ª–∏ –≤ –Ω–∞—à–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–º–µ—é—Ç—Å—è –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞, –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –∏—Ö –≤ –∑–∞–ø—Ä–æ—Å —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `initialData`, –º–∏–Ω—É—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏.

```js
function Todos() {
  const result = useQuery('todos', () => fetch('/todos'), {
    initialData: initialTodos,
  });
}
```

#### `staleTime` –∏ `initialDataUpdatedAt`

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `initialData` —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–≤–µ–∂–∏–º–∏, –∫–∞–∫ –±—É–¥—Ç–æ –æ–Ω–∏ –±—ã–ª–∏ —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–ª—É—á–µ–Ω—ã. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `staleTime` (–≤—Ä–µ–º—è —É—Å—Ç–∞—Ä–µ–≤–∞–Ω–∏—è):

- –ï—Å–ª–∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞ –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–º–æ—â—å—é `initialData` –∏ –Ω–µ –±—ã–ª–æ —É–∫–∞–∑–∞–Ω–æ `staleTime` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `staleTime` —Ä–∞–≤–Ω—è–µ—Ç—Å—è `0`), –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–≤—Ç–æ—Ä–Ω–æ –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:

```js
function Todos() {
  // initialTodos –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ –∏ —Å—Ä–∞–∑—É –∂–µ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–¥–∞—á
  const result = useQuery('todos', () => fetch('/todos'), {
    initialData: initialTodos,
  });
}
```

- –ï—Å–ª–∏ –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –∑–∞–ø—Ä–æ—Å–∞ –±—ã–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–º–æ—â—å—é `initialData` –∏ –±—ã–ª–æ —É–∫–∞–∑–∞–Ω–æ `staleTime` –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ `1000` –º—Å, –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —Å–≤–µ–∂–∏–º–∏ –Ω–∞ –ø—Ä–æ—Ç—è–∂–µ–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:

```js
function Todos() {
  // initialTodos –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –±—É–¥—É—Ç –∑–∞–ø—Ä–æ—à–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥—Ä—É–≥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Å–ø—É—Å—Ç—è 1000 –º—Å
  const result = useQuery('todos', () => fetch('/todos'), {
    initialData: initialTodos,
    staleTime: 1000,
  });
}
```

- –ß—Ç–æ –µ—Å–ª–∏ –Ω–∞—à–∏ –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ–≤—Å–µ–º —Å–≤–µ–∂–∏–µ? –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `initialDataUpdatedAt` –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –º—Å:

```js
function Todos() {
  // initialTodos –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ, –Ω–æ –Ω–µ –±—É–¥—É—Ç –∑–∞–ø—Ä–æ—à–µ–Ω—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥—Ä—É–≥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è —Å–ø—É—Å—Ç—è 1 –º–∏–Ω –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  const result = useQuery('todos', () => fetch('/todos'), {
    initialData: initialTodos,
    staleTime: 60 * 1000 // 1 –º–∏–Ω—É—Ç–∞
    // –≠—Ç–æ –º–æ–≥–ª–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏ 10 —Å–µ–∫—É–Ω–¥ –∏–ª–∏ 10 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥
    initialDataUpdatedAt: initialTodosUpdatedTimestamp // –Ω–∞–ø—Ä–∏–º–µ—Ä, 1608412420052
  })
}
```

#### –§—É–Ω–∫—Ü–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–º –∏–ª–∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –æ–Ω –ø–æ–≤—Ç–æ—Ä—è–ª—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ, —Ç–æ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–Ω–∞—á–µ–Ω–∏—è `initialData` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞:

```js
function Todos() {
  const result = useQuery('todos', () => fetch('/todos'), {
    initialData: () => {
      return getExpensiveTodos();
    },
  });
}
```

#### –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥—Ä—É–≥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞—é. –•–æ—Ä–æ—à–∏–º –ø—Ä–∏–º–µ—Ä–æ–º —Ç–∞–∫–æ–≥–æ —Å–ª—É—á–∞—è —è–≤–ª—è–µ—Ç—Å—è –ø–æ–∏—Å–∫ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏:

```js
function Todo({ todoId }) {
  const result = useQuery(
    ['todo', todoId],
    () => fetch('/todos'),
    {
      initialData: () => {
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∑–∞–¥–∞—á—É –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ 'todos' –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏
        return queryClient
          .getQueryData('todos')
          ?.find((d) => d.id === todoId);
      },
    }
  );
}
```

#### –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ —Å `initialDataUpdatedAt`

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞ —è–≤–ª—è—é—Ç—Å—è —Å–≤–µ–∂–∏–º–∏ –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `initialDataUpdatedAt`:

```js
function Todo({ todoId }) {
  const result = useQuery(
    ['todo', todoId],
    () => fetch('/todos'),
    {
      initialData: () =>
        queryClient
          .getQueryData('todos')
          ?.find((d) => d.id === todoId),
      initialDataUpdatedAt: () =>
        queryClient.getQueryState('todos')?.dataUpdatedAt,
    }
  );
}
```

#### –£—Å–ª–æ–≤–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—ç—à–∞

–ï—Å–ª–∏ –º—ã –Ω–µ —Ö–æ—Ç–∏–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫—ç—à –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–æ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `queryClient.getQueryState` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –≤–∫–ª—é—á–∞—è `state.dataUpdatedAt`, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–≥–æ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ª–∏ —Å–≤–µ–∂–∏–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```js
function Todo({ todoId }) {
  const result = useQuery(
    ['todo', todoId],
    () => fetch('/todos'),
    {
      initialData: () => {
        // –ü–æ–ª—É—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
        const state = queryClient.getQueryState('todos');

        // –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–µ —Å—Ç–∞—Ä—à–µ 10 —Å–µ–∫—É–Ω–¥...
        if (
          state &&
          Date.now() - state.dataUpdatedAt <= 10 * 1000
        ) {
          // –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É
          return state.data.find((d) => d.id === todoId);
        }

        // –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º undefined, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
      },
    }
  );
}
```

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

–ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–µ–¥—É–≥–∞–¥—ã–≤–∞—Ç—å –∂–µ–ª–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –º—ã –º–æ–∂–µ–º –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ –∑–∞–±–ª–∞–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–º–µ—Å—Ç–∏—Ç—å –∏—Ö –≤ –∫—ç—à:

```js
const prefetchTodos = async () => {
  // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥—É—Ç –ø–æ–º–µ—â–µ–Ω—ã –≤ –∫—ç—à –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—ã—á–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  await queryClient.prefetchQuery('todos', fetchTodos);
};
```

- –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —É–∂–µ –∏–º–µ—é—Ç—Å—è –≤ –∫—ç—à–µ –∏ –Ω–µ –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω—ã, –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–µ –±—É–¥–µ—Ç
- –ï—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ `staleTime`, –Ω–∞–ø—Ä–∏–º–µ—Ä, `prefetchQuery('todos', fn, { staleTime: 5000 })` –∏ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—à–µ, —á–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ `staleTime`, –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω
- –ï—Å–ª–∏ –Ω–µ –∏–º–µ–µ—Ç—Å—è –Ω–∏ –æ–¥–Ω–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `useQuery` –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –æ–Ω –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ `cacheTime`

–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã, –∫–æ–≥–¥–∞ —É –Ω–∞—Å —É–∂–µ –∏–º–µ—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞, –Ω–∞–º –Ω–µ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏–µ. –ú—ã –º–æ–∂–µ–º –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ `setQueryData` –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ –∫–ª—é—á—É:

```js
queryClient.setQueryData('todos', todos);
```

## –ú—É—Ç–∞—Ü–∏–∏

–í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤, –º—É—Ç–∞—Ü–∏–∏, –æ–±—ã—á–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/—É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ö—É–∫ `useMutation`.

–ü—Ä–∏–º–µ—Ä –º—É—Ç–∞—Ü–∏–∏, –¥–æ–±–∞–≤–ª—è—é—â–µ–π –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```js
function App() {
  const mutation = useMutation((newTodo) =>
    axios.post('/todos', newTodo)
  );

  return (
    <div>
      {mutation.isLoading ? (
        <p>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏...</p>
      ) : (
        <>
          {mutation.isError ? (
            <p>–í–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞: {mutation.error.message}</p>
          ) : null}

          {mutation.isSuccess ? (
            <p>–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞!</p>
          ) : null}

          <button
            onClick={() =>
              mutation.mutate({
                id: new Date(),
                title: 'Hello World',
              })
            }
          >
            –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
          </button>
        </>
      )}
    </div>
  );
}
```

–ú—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π:

- `isIdle` –∏–ª–∏ `status === 'idle'` - –º—É—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è –∏–ª–∏ –Ω–∞ —Å—Ç–∞–¥–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è/—Å–±—Ä–æ—Å–∞
- `isLoading` –∏–ª–∏ `status === 'loading'` - –º—É—Ç–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
- `isError` –∏–ª–∏ `status === 'error'` - –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–∏ –≤–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞
- `isSuccess` –∏–ª–∏ `status === 'success'` - –º—É—Ç–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã

–¢–∞–∫–∂–µ, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –º—É—Ç–∞—Ü–∏–∏, –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

- `error` - –µ—Å–ª–∏ –º—É—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `isError`, –æ—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `error`
  `data` - –µ—Å–ª–∏ –º—É—Ç–∞—Ü–∏—è –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `success`, –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ —Å–≤–æ–π—Å—Ç–≤–æ `data`

–§—É–Ω–∫—Ü–∏—è `mutate` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –∏–ª–∏ –æ–±—ä–µ–∫—Ç.

–ü—Ä–∏ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π `onSuccess`, –º–µ—Ç–æ–¥–∞–º–∏ `invalidateQueries` –∏ `setQueryData` –º—É—Ç–∞—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –æ—á–µ–Ω—å –º–æ—â–Ω—ã–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º.

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: —Ñ—É–Ω–∫—Ü–∏—è `mutate` —è–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–ª–±–µ–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Å–æ–±—ã—Ç–∏–π. –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–±—ã—Ç–∏—é –≤ `onSubmit` —Å–ª–µ–¥—É–µ—Ç –æ–±–µ—Ä–Ω—É—Ç—å `mutate` –≤ –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é.

```js
// –≠—Ç–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥–µ—Ç
const CreateTodo = () => {
  const mutation = useMutation((event) => {
    event.preventDefault();
    return fetch('/api', new FormData(event.target));
  });

  return <form onSubmit={mutation.mutate}>...</form>;
};

// –ê —ç—Ç–æ –±—É–¥–µ—Ç
const CreateTodo = () => {
  const mutation = useMutation((formData) => {
    return fetch('/api', formData);
  });
  const onSubmit = (event) => {
    event.preventDefault();
    mutation.mutate(new FormData(event.target));
  };

  return <form onSubmit={onSubmit}>...</form>;
};
```

### –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –º—É—Ç–∞—Ü–∏–∏

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—á–∏—Å—Ç–∏—Ç—å `error` –∏–ª–∏ `data` –º—É—Ç–∞—Ü–∏–∏. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `reset`:

```js
const createTodo = () => {
  const [title, setTitle] = useState('');
  const mutation = useMutation(createTodo);

  const handleSubmit = (e) => {
    e.preventDefault();
    mutation.mutate({ title });
  };

  return (
    <form onSubmit={handleSubmit}>
      {mutation.error && (
        <h5 onClick={() => mutation.reset()}>
          {mutation.error}
        </h5>
      )}
      <input
        type="text"
        value={title}
        onChange={(e) => setTitle(e.target.value)}
      />
      <br />
      <button type="submit">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
    </form>
  );
};
```

### –ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –º—É—Ç–∞—Ü–∏–∏

`useMutation` —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —É—Ç–∏–ª–∏—Ç—ã, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–∞ –ª—é–±–æ–π —Å—Ç–∞–¥–∏–∏ –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –º—É—Ç–∞—Ü–∏–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –∫–∞–∫ –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–∏, —Ç–∞–∫ –∏ –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

```js
useMutation(addTodo, {
  onMutate: (vars) => {
    // –ü—Ä–æ–∏–∑–æ—à–ª–∞ –º—É—Ç–∞—Ü–∏—è

    // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–∞–ø—Ä–∏–º–µ—Ä
    return { id: 1 };
  },
  onError: (error, vars, context) => {
    // –í–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞
    console.log(
      `–û—Ç–º–µ–Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å id ${context.id}`
    );
  },
  onSuccess: (data, vars, context) => {
    // –ú—É—Ç–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ
  },
  onSettled: (data, error, vars, context) => {
    // –û—à–∏–±–∫–∞ –∏–ª–∏ —É—Å–ø–µ—Ö... –Ω–µ–≤–∞–∂–Ω–æ
  },
});
```

–ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –ø—Ä–æ–º–∏—Å–∞ –∏–∑ –ª—é–±–æ–≥–æ –∫–æ–ª–±–µ–∫–∞, —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ–º–∏—Å –±—É–¥–µ—Ç –∂–¥–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ:

```js
useMutation(addTodo, {
  onSuccess: async () => {
    console.log('–ü–µ—Ä–≤—ã–π!');
  },
  onSettled: async () => {
    console.log('–í—Ç–æ—Ä–æ–π!');
  },
});
```

–ü—Ä–∏ –≤—ã–∑–æ–≤–µ `mutate` –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–±–µ–∫–∏, –∫—Ä–æ–º–µ —Ç–µ—Ö, —á—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ `useMutation`. –≠—Ç–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å —Ç–∞–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤, –∫–∞–∫ `onSuccess`, `onError` –∏ `onSettled`:

```js
useMutation(addTodo, {
  onSuccess: (data, vars, context) => {
    // –ü–µ—Ä–≤—ã–π
  },
  onError: (error, vars, context) => {
    // –ü–µ—Ä–≤—ã–π
  },
  onSettled: (data, error, vars, context) => {
    // –ü–µ—Ä–≤—ã–π
  },
});

mutate(todo, {
  onSuccess: (data, vars, context) => {
    // –í—Ç–æ—Ä–æ–π
  },
  onError: (error, vars, context) => {
    // –í—Ç–æ—Ä–æ–π
  },
  onSettled: (data, error, vars, context) => {
    // –í—Ç–æ—Ä–æ–π
  },
});
```

### –ü—Ä–æ–º–∏—Å—ã

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–º–∏—Å–∞, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞ –∏–ª–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É, —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `mutateAsync` –≤–º–µ—Å—Ç–æ `mutate`. –≠—Ç–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –∏–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤:

```js
const mutation = useMutation(addTodo);

try {
  const todo = await mutation.mutateAsync(todo);
  console.log(todo);
} catch (error) {
  console.error(error);
} finally {
  console.log('–í—ã–ø–æ–ª–Ω–µ–Ω–æ');
}
```

### –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `React Query` –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ –ø—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏, –Ω–æ —ç—Ç–æ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `retry`:

```js
const mutation = useMutation(addTodo, {
  retry: 3,
});
```

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏

–ú—É—Ç–∞—Ü–∏–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –ø–æ–º–æ—â—å—é –¥–µ–≥–∏–¥—Ä–∞—Ü–∏–∏/–≥–∏–¥—Ä–∞—Ü–∏–∏:

```js
const queryClient = new QueryClient();

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º—É—Ç–∞—Ü–∏—é "addTodo"
queryClient.setMutationDefaults('addTodo', {
  mutationFn: addTodo,
  onMutate: async (vars) => {
    // –û—Ç–º–µ–Ω–∞ —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á
    await queryClient.cancelQueries('todos');

    // –°–æ–∑–¥–∞–µ–º –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É
    const optimisticTodo = {
      id: uuid(),
      title: vars.title,
    };

    // –î–æ–±–∞–≤–ª—è–µ–º –µ–µ –≤ —Å–ø–∏—Å–æ–∫
    queryClient.setQueryData('todos', (oldTodos) => [
      ...oldTodos,
      optimisticTodo,
    ]);

    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–µ–π
    return { optimisticTodo };
  },
  onSuccess: (result, vars, context) => {
    // –ó–∞–º–µ–Ω—è–µ–º –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É –≤ —Å–ø–∏—Å–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –º—É—Ç–∞—Ü–∏–∏
    queryClient.setQueryData('todos', (oldTodos) =>
      oldTodos.map((todo) =>
        todo.id === context.optimisticTodo.id
          ? result
          : todo
      )
    );
  },
  onError: (error, vars, context) => {
    // –£–¥–∞–ª—è–µ–º –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫—É—é –∑–∞–¥–∞—á—É –∏–∑ —Å–ø–∏—Å–∫–∞
    queryClient.setQueryData('todos', (oldTodos) =>
      oldTodos.filter(
        (todo) => todo.id !== context.optimisticTodo.id
      )
    );
  },
  retry: 3,
});

// –ó–∞–ø—É—Å–∫–∞–µ–º –º—É—Ç–∞—Ü–∏—é –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const mutation = useMutation('addTodo');
mutation.mutate({ title: 'test' });

// –ï—Å–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –ø—Ä–∏—á–∏–Ω–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫ —Å–µ—Ç–∏,
// —Ç–∞–∫–∞—è –º—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–µ–≥–∏–¥—Ä–∞—Ç–∏—Ä–æ–≤–∞–Ω–∞
const state = dehydrate(queryClient);

// –ó–∞—Ç–µ–º –¥–∞–Ω–Ω–∞—è –º—É—Ç–∞—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≥–∏–¥—Ä–∞—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
hydrate(queryClient, state);

// –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –º—É—Ç–∞—Ü–∏–∏
queryClient.resumePausedMutation();
```

## –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

–ú–µ—Ç–æ–¥ `invalidateQueries` –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–º–µ—á–∞—Ç—å –∑–∞–ø—Ä–æ—Å–∞ –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:

```js
// –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –∫—ç—à–µ
queryClient.invalidateQueries();
// –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–∏ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `todos`
queryClient.invalidateQueries('todos');
```

–ü—Ä–∏ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é `invalidateQueries` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –¥–≤–µ –≤–µ—â–∏:

- –û–Ω –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π. –ü—Ä–∏ —ç—Ç–æ–º, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `staleTime` –≤ `useQuery` –∏ –¥—Ä—É–≥–∏—Ö —Ö—É–∫–∞—Ö –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
- –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω —Å –ø–æ–º–æ—â—å—é `useQuery` –∏–ª–∏ –¥—Ä—É–≥–∏—Ö —Ö—É–∫–æ–≤, –æ–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

### –ü–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é `invalidateQueries`

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ç–∞–∫–∏—Ö API, –∫–∞–∫ `invalidateQueries` –∏ `removeQueries` (–∏ –¥—Ä—É–≥–∏—Ö, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏—Ö –ø–æ–∏—Å–∫ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è), –º–æ–∂–Ω–æ –æ—Å—É—â–µ—Å—Ç–≤–ª—è—Ç—å –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É –∏–ª–∏ –∏—Å–∫–∞—Ç—å –ø–æ–ª–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è.

–í —Å–ª–µ–¥—É—é—â–µ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–µ—Ñ–∏–∫—Å `todos` –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ª—é–±—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–∏ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `todos`:

```js
import { useQuery, useQueryClient } from 'react-query';

// –ü–æ–ª—É—á–∞–µ–º QueryClient –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
const queryClient = useQueryClient();

queryClient.invalidateQueries('todos');

// –û–±–∞ –∑–∞–ø—Ä–æ—Å–∞ –±—É–¥—É—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω—ã
const todoListQuery = useQuery('todos', fetchTodoList);
const todoListQuery = useQuery(
  ['todos', { page: 1 }],
  fetchTodoList
);
```

–í –º–µ—Ç–æ–¥ `invalidateQueries` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```js
queryClient.invalidateQueries(['todos', { type: 'done' }]);

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(
  ['todos', { type: 'done' }],
  fetchTodoList
);

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ù–ï –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery('todos', fetchTodoList);
```

API `invalidateQueries` —è–≤–ª—è–µ—Ç—Å—è –æ—á–µ–Ω—å –≥–∏–±–∫–∏–º, –ø–æ—ç—Ç–æ–º—É, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã —Å –∫–ª—é—á–æ–º `todos` –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–ª–∏ –∫–ª—é—á–µ–π, —Ç–æ –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É `exact: true`:

```js
queryClient.invalidateQueries('todos', { exact: true });

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(['todos'], fetchTodoList);

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ù–ï –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(
  ['todos', { type: 'done' }],
  fetchTodoList
);
```

–í `invalidateQueries` —Ç–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é-–ø—Ä–µ–¥–∏–∫–∞—Ç. –î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∫–∞–∂–¥—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä `Query` –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `true` –∏–ª–∏ `false` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª–æ–≤–∏—è:

```js
queryClient.invalidateQueries({
  predicate: (query) =>
    query.queryKey[0] === 'todos' &&
    query.queryKey[1]?.version >= 10,
});

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(
  ['todos', { version: 20 }],
  fetchTodoList
);

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ç–∞–∫–∂–µ –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(
  ['todos', { version: 10 }],
  fetchTodoList
);

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –ù–ï –±—É–¥–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω
const todoListQuery = useQuery(
  ['todos', { version: 5 }],
  fetchTodoList
);
```

## –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é –º—É—Ç–∞—Ü–∏–π

–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ - —ç—Ç–æ –ø–æ–ª–æ–≤–∏–Ω–∞ —É—Å–ø–µ—Ö–∞. –í—Ç–æ—Ä–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ - –∑–Ω–∞—Ç—å, –∫–æ–≥–¥–∞ –∏—Ö —Å–ª–µ–¥—É–µ—Ç –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å. –û–±—ã—á–Ω–æ, –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–π –∑–∞–ø—Ä–æ—Å—ã –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏.

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —É –Ω–∞—Å –∏–º–µ–µ—Ç—Å—è –º—É—Ç–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏:

```js
const mutation = useMutation(postTodo);
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–∏ `postTodo`, –Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å –∫–ª—é—á–æ–º `todos` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω–æ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏. –î–ª—è —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É `onSuccess` –∏ —Ñ—É–Ω–∫—Ü–∏—é `invalidateQueries`:

```js
import { useMutation, useQueryClient } from 'react-query';

const queryClient = useQueryClient();

// –ê–Ω–Ω—É–ª–∏—Ä—É–µ–º –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã —Å –∫–ª—é—á–∞–º–∏ `todos` –∏ `reminders` –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º—É—Ç–∞—Ü–∏–∏
const mutation = useMutation(addTodo, {
  onSuccess: () => {
    queryClient.invalidateQueries('todos');
    queryClient.invalidateQueries('reminders');
  },
});
```

–ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –ª—é–±–æ–º –∫–æ–ª–±–µ–∫–µ —Ö—É–∫–∞ `useMutation`.

## –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω—ã—Ö, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö –º—É—Ç–∞—Ü–∏–µ–π

–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–π, –æ–±–Ω–æ–≤–ª—è—é—â–∏—Ö –æ–±—ä–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –≤ –æ—Ç–≤–µ—Ç, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç. –í–º–µ—Å—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤, –≤–æ–∑–≤—Ä–∞—â–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `setQueryData` –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞:

```js
const queryClient = useQueryClient();

const mutation = useMutation(editTodo, {
  onSuccess: (data) =>
    queryClient.setQueryData(['todo', { id: 5 }], data),
});

mutation.mutate({
  id: 5,
  name: 'Hello World',
});

// –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω —Å –ø–æ–º–æ—â—å—é –æ—Ç–≤–µ—Ç–∞ –æ—Ç —É—Å–ø–µ—à–Ω–æ–π –º—É—Ç–∞—Ü–∏–∏
const { status, data, error } = useQuery(
  ['todo', { id: 5 }],
  fetchTodoById
);
```

–õ–æ–≥–∏–∫—É `onSuccess` –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –º—É—Ç–∞—Ü–∏—é (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ö—É–∫):

```js
const useMutateTodo = () => {
  const queryClient = useQueryClient();

  return useMutation(editTodo, {
    // –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ: –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç - —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—è `mutate`
    onSuccess: (data, vars) => {
      queryClient.setQueryData(
        ['todo', { id: vars.id }],
        data
      );
    },
  });
};
```

## –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

–û–±—Ä–∞–±–æ—Ç—á–∏–∫ `onMutate` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ `onError` –∏ `onSettled` –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç–º–µ–Ω—ã.

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏

```js
const queryClient = useQueryClient();

useMutation(updateTodo, {
  // –ü—Ä–∏ –≤—ã–∑–æ–≤–µ –º—É—Ç–∞—Ü–∏–∏
  onMutate: async (newTodo) => {
    // –û—Ç–º–µ–Ω—è–µ–º –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã (—á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–ª–∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)
    await queryClient.cancelQueries('todos');

    // –°–Ω–∏–º–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    const prevTodos = queryClient.getQueryData('todos');

    // –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    queryClient.setQueryData('todos', (oldTodos) =>
      oldTodos.concat(newTodo)
    );

    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –æ–±—ä–µ–∫—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
    return { prevTodos };
  },
  // –ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –º—É—Ç–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∏–∑ onMutate –¥–ª—è –æ—Ç–º–µ–Ω—ã –º—É—Ç–∞—Ü–∏–∏
  onError: (err, newTodo, context) => {
    queryClient.setQueryData('todos', context.prevTodos);
  },
  // –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
  onSettled: () => {
    queryClient.invalidateQueries('todos');
  },
});
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏

```js
useMutation(updateTodo, {
  // –ü—Ä–∏ –≤—ã–∑–æ–≤–µ –º—É—Ç–∞—Ü–∏–∏
  onMutate: async (newTodo) => {
    // –û—Ç–º–µ–Ω—è–µ–º –∏—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
    await queryClient.cancelQueries(['todos', newTodo.id]);

    // –°–Ω–∏–º–æ–∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
    const prevTodo = queryClient.getQueryData([
      'todos',
      newTodo.id,
    ]);

    // –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
    queryClient.setQueryData(
      ['todos', newTodo.id],
      newTodo
    );

    // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∏ –Ω–æ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
    return { prevTodo, newTodo };
  },
  // –ü—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –º—É—Ç–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç
  onError: (err, newTodo, context) => {
    queryClient.setQueryData(
      ['todos', context.newTodo.id],
      context.prevTodo
    );
  },
  // –í—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
  onSettled: (newTodo) => {
    queryClient.invalidateQueries(['todos', newTodo.id]);
  },
});
```

–í–º–µ—Å—Ç–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ `onError` –∏ `onSuccess` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `onSettled`:

```js
useMutation(updateTodo, {
  // ...
  onSettled: (newTodo, error, variables, context) => {
    if (error) {
      // ...
    }
  },
});
```

## –û—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞

`React Query` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—â–∏–π —Å–ø–æ—Å–æ–± –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –ø–æ–º–æ—â—å—é —Ç–æ–∫–µ–Ω–∞ –æ—Ç–º–µ–Ω—ã –∏–ª–∏ –¥—Ä—É–≥–æ–≥–æ API. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `cancel` –∫ –ø—Ä–æ–º–∏—Å—É, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–º—É –∑–∞–ø—Ä–æ—Å–æ–º, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –æ—Ç–º–µ–Ω—ã. –ö–æ–≥–¥–∞ –∑–∞–ø—Ä–æ—Å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–º, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `promise.cancel`.

### –° –ø–æ–º–æ—â—å—é `axios`

```js
import { CancelToken } from 'axios';

const query = useQuery('todos', () => {
  // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω –æ—Ç–º–µ–Ω—ã –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  const source = CancelToken.source();

  const promise = axios('/todos', {
    cancelToken: source.token,
  });

  promise.cancel = () => {
    source.cancel('–ó–∞–ø—Ä–æ—Å –±—ã–ª –æ—Ç–º–µ–Ω–µ–Ω');
  };

  return promise;
});
```

### –° –ø–æ–º–æ—â—å—é `fetch`

```js
const query = useQuery('todos', () => {
  // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä `AbortController` –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  const controller = new AbortController();
  // –ü–æ–ª—É—á–∞–µ–º —Å–∏–≥–Ω–∞–ª
  const signal = controller.signal;

  const promise = fetch('/todos', {
    method: 'GET',
    // –ü–µ—Ä–µ–¥–∞–µ–º —Å–∏–≥–Ω–∞–ª –≤ –∑–∞–ø—Ä–æ—Å
    signal,
  });

  // –û—Ç–º–µ–Ω—è–µ–º –∑–∞–ø—Ä–æ—Å
  promise.cancel = () => controller.abort();

  return promise;
});
```

### –†—É—á–Ω–∞—è –æ—Ç–º–µ–Ω–∞

–í —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –º—ã –º–æ–∂–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–º–µ–Ω—ã —Ç–∞–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –≠—Ç–æ –º–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –≤—ã–∑–æ–≤–∞ `queryClient.cancelQueries(key)`. –ï—Å–ª–∏ `promise.cancel` —è–≤–ª—è–µ—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º, `React Query` –æ—Ç–º–µ–Ω–∏—Ç –∑–∞–ø—Ä–æ—Å:

```js
const [queryKey] = useState('todos');

const query = useQuery(queryKey, () => {
  const controller = new AbortController();
  const signal = controller.signal;

  const promise = fetch('/todos', {
    signal,
  });

  promise.cancel = () => controller.abort();

  return promise;
});

const queryClient = useQueryClient();

return (
  <button
    onClick={(e) => {
      e.preventDefault();
      queryClient.cancelQueries(queryKey);
    }}
  >
    –û—Ç–º–µ–Ω–∏—Ç—å
  </button>
);
```

## –§–∏–ª—å—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –º–µ—Ç–æ–¥—ã `React Query` –ø—Ä–∏–Ω–∏–º–∞—é—Ç –æ–±—ä–µ–∫—Ç `QueryFilters`. –§–∏–ª—å—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞ - —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å —É—Å–ª–æ–≤–∏—è–º–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –∑–∞–ø—Ä–æ—Å–æ–º:

```js
// –û—Ç–º–µ–Ω–∞ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
await queryClient.cancelQueries();

// –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
queryClient.removeQueries('posts', { inactive: true });

// –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
await queryClient.refetchQueries({ active: true });

// –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–∏ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `post`
await queryClient.refetchQueries('posts', { active: true });
```

–û–±—ä–µ–∫—Ç `QueryFilters` –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞:

- `exact` - –ø–æ–∏—Å–∫ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –∫–ª—é—á–æ–º –∑–∞–ø—Ä–æ—Å–∞
- `active`- –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- `inactive` - –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏/–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- `stale` - –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏/—Å–≤–µ–∂–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- `fetching` - –ø–æ–∏—Å–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏, –Ω–∞—Ö–æ–¥—è—â–∏–º–∏—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∏–ª–∏ —Å–æ –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- `predicate` - —Ñ—É–Ω–∫—Ü–∏—è-–ø—Ä–µ–¥–∏–∫–∞—Ç, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è `true` –¥–ª—è –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- `queryKey` - –∫–ª—é—á –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è

## –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞

`React Query` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –∏—Ö –∫–ª–∏–µ–Ω—Ç—É –∑–∞–ø—Ä–æ—Å–∞:

- –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –ø–µ—Ä–µ–¥–∞—á–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ `initialData`
  - –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞—è—Ö
  - –ò–º–µ–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –¥–µ–≥–∏–¥—Ä–∞—Ü–∏—è –∫—ç—à–∞ –∏ —Ä–µ–≥–∏–¥—Ä–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
  - –¢—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Next.js`

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Next.js`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–µ —Ñ–æ—Ä–º—ã –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞, —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∞–π—Ç–æ–≤ (SSG)
- –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ (SSR)

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `initialData`

–° –ø–æ–º–æ—â—å—é `getStaticProps` –∏–ª–∏ `getServerSideProps` –∏–∑ `Next.js` –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `initialData` —Ö—É–∫–∞ `useQuery`:

```js
export async function getStaticProps() {
  const posts = await getPosts();
  return { props: { posts } };
}

function Posts(props) {
  const { data } = useQuery('posts', getPosts, {
    initialData: props.posts,
  });

  // ...
}
```

–≠—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –ø–æ–¥—Ö–æ–¥—è—â–∞—è –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞–µ–≤, –Ω–æ –æ–Ω–∞ –∏–º–µ–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

- –í—ã–∑–æ–≤ `useQuery` –≤ –≥–ª—É–±–æ–∫–æ –≤–ª–æ–∂–µ–Ω–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É `initialData` –≤ —ç—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –í—ã–∑–æ–≤ `useQuery` –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É `initialData` –≤–æ –≤—Å–µ —ç—Ç–∏ –º–µ—Å—Ç–∞
- –ù–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Å–ø–æ—Å–æ–±–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –ø–æ—ç—Ç–æ–º—É `dataUpdatedAt` –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ–≥–æ, –Ω—É–∂–¥–∞–µ—Ç—Å—è –ª–∏ –∑–∞–ø—Ä–æ—Å –≤ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≥–∏–¥—Ä–∞—Ü–∏–∏

`React Query` –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ `Next.js` –∏ –¥–µ–≥–∏–¥—Ä–∞—Ü–∏—é —ç—Ç–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ—Ç—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—É—é —Ä–∞–∑–º–µ—Ç–∫—É, –∫–æ—Ç–æ—Ä–∞—è –¥–æ—Å—Ç—É–ø–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏, –∫–∞–∫ —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–º JS, `React Query` –æ–±–Ω–æ–≤–∏—Ç —ç—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã, –∏—Å–ø–æ–ª—å–∑—É—è –≤–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. –≠—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

–î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–¥—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

- –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ `ref`. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –û–±–µ—Ä–Ω—É—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ `QueryClientProvider` –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–º—É —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∏–µ–Ω—Ç–∞
- –û–±–µ—Ä–Ω—É—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ `Hydrate` –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–º—É –ø—Ä–æ–ø `dehydrateState` –∏–∑ `pageProps`

```js
// App.js
import {
  QueryClient,
  QueryClientProvider,
} from 'react-query';
import { Hydrate } from 'react-query/hydration';

export default function App({ Component, pageProps }) {
  const queryClientRef = React.useRef();
  if (!queryClientRef.current) {
    queryClientRef.current = new QueryClient();
  }

  return (
    <QueryClientProvider client={queryClientRef.current}>
      <Hydrate state={pageProps.dehydratedState}>
        <Component {...pageProps} />
      </Hydrate>
    </QueryClientProvider>
  );
}
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `getStaticProps` (–¥–ª—è SSG) –∏–ª–∏ `getServerSideProps` (–¥–ª—è SSR):

- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏
- –í—ã–ø–æ–ª–Ω—è–µ–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø–æ–º–æ—â—å—é –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –º–µ—Ç–æ–¥–∞ `prefetchQuery` –∏ –∂–¥–µ–º –µ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `dehydrate` –¥–ª—è –¥–µ–≥–∏–¥—Ä–∞—Ü–∏–∏ –∫—ç—à–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –ø–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–ø `dehydrateState`

```js
// pages/Posts.js
import { QueryClient, useQuery } from 'react-query';
import { dehydrate } from 'react-query/hydration';

export async function getStaticProps() {
  const queryClient = new QueryClient();

  await queryClient.prefetchQuery('posts', getPosts);

  return {
    props: {
      dehydratedState: dehydrate(queryClient),
    },
  };
}

function Posts() {
  // –•—É–∫ `useQuery` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ª—é–±–æ–º –¥–æ—á–µ—Ä–Ω–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ø–æ—Å—Ç–∞–º–∏
  const { data } = useQuery('posts', getPosts);

  // –î–∞–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –Ω–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ,
  // –∏ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ, –ø–∞—Ç—Ç–µ—Ä–Ω—ã –º–æ–∂–Ω–æ —Å–º–µ—à–∏–≤–∞—Ç—å
  const { data: otherData } = useQuery('posts-2', getPosts);

  // ...
}
```

## –î–µ—Ñ–æ–ª—Ç–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞, –µ–º—É –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `defaultOptions.queries.queryFn` —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `queryClient`:

```js
// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞, –ø—Ä–∏–Ω–∏–º–∞—é—â—É—é –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞
const defaultQueryFn = async ({ queryKey }) => {
  const { data } = await axios(
    `https://jsonplaceholder.typicode.com${queryKey[0]}`
  );

  return data;
};

// –ü–µ—Ä–µ–¥–∞–µ–º –µ–µ –∫–ª–∏–µ–Ω—Ç—É –∑–∞–ø—Ä–æ—Å–∞
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      queryFn: defaultQueryFn,
    },
  },
});

const App = () => (
  <QueryClientProvider>
    <MyApp />
  </QueryClientProvider>
);

// –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞–µ–º –∫–ª—é—á
function Posts() {
  const { status, data, error, isFetching } = useQuery(
    '/posts'
  );

  // ...
}

// –î–µ—Ñ–æ–ª—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å
function Post({ postId }) {
  const { status, data, error, isFetching } = useQuery(
    `/posts/${postId}`,
    {
      enabled: !!postId,
    }
  );
}
```

–î–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤ –∑–∞–ø—Ä–æ—Å –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é.

## Suspense

`React Query` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–æ–≤–º–µ—Å—Ç–Ω–æ —Å `React Suspense`. –î–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —Ä–µ–∂–∏–º–∞ —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `suspense` –≤ `true`.

–ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:

```js
import {
  QueryClient,
  QueryClientProvider,
} from 'react-query';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      suspense: true,
    },
  },
});

export default () => (
  <QueryClientProvider client={queryClient}>
    <App />
  </QueryClientProvider>
);
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–ø—Ä–æ—Å–∞:

```js
import { useQuery } from 'react-query';

useQuery(queryKey, queryFn, { suspense: true });
```

–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è `status` –∏ –æ–±—ä–µ–∫—Ç `error` —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –∏ –∑–∞–º–µ–Ω—è—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ `React.Suspense` (–≤–∫–ª—é—á–∞—è –ø—Ä–æ–ø `fallback` –∏ –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏ –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –æ—à–∏–±–æ–∫).

–ú—É—Ç–∞—Ü–∏–∏ —Ç–∞–∫–∂–µ –≤–µ–¥—É—Ç —Å–µ–±—è –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω–∞—á–µ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤–º–µ—Å—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `error`, –º—É—Ç–∞—Ü–∏—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–µ –∏—Å–ø–æ–ª—å–∑—É—é—â–µ–≥–æ –µ–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –±–ª–∏–∂–∞–π—à–µ–º—É –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—é. –î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ç–∞–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É `useErrorBoundary` –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `false`. –î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –≤—Å–µ—Ö –æ—à–∏–±–æ–∫ —Å–ª–µ–¥—É–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É `throwOnError` —Ç–∞–∫–∂–µ –≤ –∑–Ω–∞—á–µ–Ω–∏–µ `false`.

### –°–±—Ä–æ—Å –æ—à–∏–±–æ–∫

–û—à–∏–±–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–±—Ä–æ—à–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ `QueryErrorResetBoundary` –∏–ª–∏ —Ö—É–∫–∞ `useQueryErrorResetBoundary`.

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏, –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–µ–º:

```js
import { QueryErrorResetBoundary } from 'react-query';
import { ErrorBoundary } from 'react-error-boundary';

const App = () => (
  <QueryErrorResetBoundary>
    {({ reset }) => (
      <ErrorBoundary
        onReset={reset}
        fallbackRender={({ resetErrorBoundary }) => (
          <div>
            –í–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞!
            <Button onClick={() => resetErrorBoundary()}>
              –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
            </Button>
          </div>
        )}
      >
        <Page />
      </ErrorBoundary>
    )}
  </QueryErrorResetBoundary>
);
```

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —Ö—É–∫–∞ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã –æ—à–∏–±–∫–∏ –∏–∑ –±–ª–∏–∂–∞–π—à–µ–≥–æ `QueryErrorResetBoundary`. –ï—Å–ª–∏ –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –æ—à–∏–±–∫–∏ –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã –≥–ª–æ–±–∞–ª—å–Ω–æ:

```js
import { useQueryErrorResetBoundary } from 'react-query';
import { ErrorBoundary } from 'react-error-boundary';

const App: React.FC = () => {
  const { reset } = useQueryErrorResetBoundary();
  return (
    <ErrorBoundary
      onReset={reset}
      fallbackRender={({ resetErrorBoundary }) => (
        <div>
          –í–æ–∑–Ω–∏–∫–ª–∞ –æ—à–∏–±–∫–∞!
          <Button onClick={() => resetErrorBoundary()}>
            –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
          </Button>
        </div>
      )}
    >
      <Page />
    </ErrorBoundary>
  );
};
```

## –ü–ª–∞–≥–∏–Ω—ã

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ_: –¥–∞–Ω–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è —è–≤–ª—è–µ—Ç—Å—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∏ –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è –≤ –±—É–¥—É—â–µ–º.

### persistQueryClient

`persistQueryClient` - —ç—Ç–æ —É—Ç–∏–ª–∏—Ç–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –∏ –µ–≥–æ –∫—ç—à –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ù–∞ —Å–µ–≥–æ–¥–Ω—è—à–Ω–∏–π –¥–µ–Ω—å –¥–ª—è —ç—Ç–æ–≥–æ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–ª–∞–≥–∏–Ω - `createLocalStoragePersistor`.

–ò–º–ø–æ—Ä—Ç:

```js
import { persistQueryClient } from 'react-query/persistQueryClient-experimental';
```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é `persistQueryClient` –∏ –ø–µ—Ä–µ–¥–∞–µ–º –µ–π —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` (—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π `cacheTime`) –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `Persistor` :

```js
import { persistQueryClient } from 'react-query/persistQueryClient-experimental'
import { createLocalStoragePersistor } from 'react-query/createLocalStoragePersistor-experimental'

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      cacheTime: 1000 * 60 * 60 * 24 // 24 —á–∞—Å–∞
    }
  }
})

const localStoragePersistor = createLocalStoragePersistor()

persistQueryClient({
  queryClient
  persistor: localStoragePersistor
})
```

#### API

- `persistQueryClient` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` –∏ `persistor`

```js
persistQueryClient({ queryClient, persistor });
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:

- `queryClient` - –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∞
- `persistor` - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∞
- `maxAge:` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç –∫—ç—à–∞
- `buster` - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫—ç—à–∞

–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```js
{
  (maxAge = 1000 * 60 * 60 * 24), // 24 —á–∞—Å–∞
    (buster = '');
}
```

### createLocalStoragePersistor

–ò–º–ø–æ—Ä—Ç:

```js
import { createLocalStoragePersistor } from 'react-query/createLocalStoragePersistor-experimental';
```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é `createLocalStoragePersistor`
- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π `localStoragePersistor`
- –ü–µ—Ä–µ–¥–∞–µ–º –µ–≥–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `persistQueryClient`

```js
import { persistQueryClient } from 'react-query/persistQueryClient-experimental';
import { createLocalStoragePersistor } from 'react-query/createLocalStoragePersistor-experimental';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      cacheTime: 1000 * 60 * 60 * 24, // 24 —á–∞—Å–∞
    },
  },
});

const localStoragePersistor = createLocalStoragePersistor();

persistQueryClient({
  queryClient,
  persistor: localStoragePersistor,
});
```

#### API

- `createLocalStoragePersistor` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `localStoragePersistor`, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –≤ `persisteQueryClient`

```js
createLocalStoragePersistor(options?)
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:

- `localStorageKey` - –∫–ª—é—á, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—ç—à–∞
- `throttleTime` - "—Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥" –∑–∞–ø–∏—Å–∏ –∑–Ω–∞—á–µ–Ω–∏–π –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ

–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```js
{
  (localStorageKey = `REACT_QUERY_OFFLINE_CACHE`),
    (throttleTime = 1000);
}
```

### broadcastQueryClient

`broadcastQueryClient` - —ç—Ç–æ —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –≤–µ—â–∞–Ω–∏—è) –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∑–∞–ø—Ä–æ—Å–∞ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏/–æ–∫–Ω–∞–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –æ–¥–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (same origin).

–ò–º–ø–æ—Ä—Ç:

```js
import { broadcastQueryClient } from 'react-query/broadcastQueryClient-experimental';
```

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è.

–ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é `broadcastQueryClient` –∏ –ø–µ—Ä–µ–¥–∞–µ–º –µ–π —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º `broadcastChannel`:

```js
import { broadcastQueryClient } from 'react-query/broadcastQueryClient-experimental';

const queryClient = new QueryClient();

broadcastQueryClient({
  queryClient,
  broadcastChannel: 'my-app',
});
```

### API

- `broadcastQueryClient` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient` –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, `broadcastChannel`

```js
broadcastQueryClient({ queryClient, broadcastChannel });
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:

- `queryClient` - –∫–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–æ—Å–∞
- `broadcastChannel` - —É–Ω–∏–∫–∞–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏/–æ–∫–Ω–∞–º–∏

–î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```js
{
  broadcastChannel = 'react-query',
}
```

## –û—Å–Ω–æ–≤–Ω—ã–µ —á–∞—Å—Ç–∏ API

### useQuery

```js
const {
  data,
  dataUpdatedAt,
  error,
  errorUpdatedAt,
  failureCount,
  isError,
  isFetched,
  isFetchedAfterMount,
  isFetching,
  isIdle,
  isLoading,
  isLoadingError,
  isPlaceholderData,
  isPreviousData,
  isRefetchError,
  isStale,
  isSuccess,
  refetch,
  remove,
  status,
} = useQuery(queryKey, queryFn?, {
  cacheTime,
  enabled,
  initialData,
  initialDataUpdatedAt
  isDataEqual,
  keepPreviousData,
  notifyOnChangeProps,
  notifyOnChangePropsExclusions,
  onError,
  onSettled,
  onSuccess,
  queryKeyHashFn,
  refetchInterval,
  refetchIntervalInBackground,
  refetchOnMount,
  refetchOnReconnect,
  refetchOnWindowFocus,
  retry,
  retryOnMount,
  retryDelay,
  select,
  staleTime,
  structuralSharing,
  suspense,
  useErrorBoundary
})

// –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –æ–±—ä–µ–∫—Ç–∞
const result = useQuery({
  queryKey,
  queryFn,
  enabled
})
```

#### –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- `queryKey | array` - —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–ª–∏ –º–∞—Å—Å–∏–≤: –∫–ª—é—á –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞. –ó–∞–ø—Ä–æ—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ –∫–ª—é—á–∞ (–µ—Å–ª–∏ `enabled` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `false`)
- `queryFn` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç `QueryFunctionContext` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `queryKey`. –î–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—Ä–æ–º–∏—Å, —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–π—Å—è –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—â–∏–π –∏—Å–∫–ª—é—á–µ–Ω–∏–µ
- `enabled` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
- `retry ` - –∫–æ–ª–∏—á–µ—Å—Ç–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ (`true` - –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫)
- `retryDelay` - —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ `retryAttempt` –∏ –æ—à–∏–±–∫—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –∑–∞–¥–µ—Ä–∂–∫—É, –ø—Ä–∏–º–µ–Ω—è–µ–º—É—é –ø–µ—Ä–µ–¥ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ø—ã—Ç–∫–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –≤ –º—Å. –§—É–Ω–∫—Ü–∏—è `attempt => Math.min(attempt > 1 ? 2 ** attempt * 1000 : 1000, 30 * 1000)` –ø—Ä–∏–º–µ–Ω—è–µ—Ç —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É. –§—É–Ω–∫—Ü–∏—è `attempt => attempt * 1000` –ø—Ä–∏–º–µ–Ω—è–µ—Ç –ª–∏–Ω–µ–π–Ω—É—é –∑–∞–¥–µ—Ä–∂–∫—É
- `staleTime` - –≤—Ä–µ–º—è –≤ –º—Å, –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ (`Infinity` - –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å—Å—è —Å–≤–µ–∂–∏–º–∏)
- `cacheTime` - –≤—Ä–µ–º—è –≤ –º—Å, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π/–Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–π –∫—ç—à —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ç–∞–∫–æ–π –∫—ç—à —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞ (`Infinity` - –∫—ç—à –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –±—É–¥–µ—Ç —Å–æ–±—Ä–∞–Ω)
- `refetchInterval` - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ (–ø–µ—Ä–∏–æ–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ –º—Å)
- `notifyOnChangeProps` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —É–∫–∞–∑–∞–Ω–∏–∏ `['data', 'error']`, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `data` –∏–ª–∏ `error`. `tracked` –æ–∑–Ω–∞—á–∞–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Å–≤–æ–π—Å—Ç–≤
- `onSuccess` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç `data`
- `onError` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç `error`
- `onSettled` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–∑—ã–≤–∞–µ–º–∞—è –∫–∞–∫ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, —Ç–∞–∫ –∏ –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ª—É—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã `data` –∏ `error`
- `select` - —Ñ—É–Ω–∫—Ü–∏—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–ª–∏ –≤—ã–±–æ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- `initialData` - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –∫—ç—à–∞ –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è, –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –¥–æ–ª–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ù–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—á–∏—Ç–∞—é—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏, –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ `staleTime`
- `initialDataUpdatedAt` - –≤—Ä–µ–º—è –≤ –º—Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `initialData`
- `placeholderData` - –¥–∞–Ω–Ω—ã–µ-–∑–∞–º–µ–Ω–∏—Ç–µ–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞—Å—Ç–æ—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ `initialData`
- `keepPreviousData` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–æ–≤—ã—Ö (–ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª—é—á–∞ –∑–∞–ø—Ä–æ—Å–∞)

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

- `status` - –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
  - `idle` - –≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ —Å `enabled: false` –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
  - `loading` - –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - `error` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å –æ—à–∏–±–∫–æ–π
  - `success` - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ. –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ —Å–≤–æ–π—Å—Ç–≤–æ `data` - —ç—Ç–æ –¥–∞–Ω–Ω—ã–µ, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞, –∏–ª–∏, –ø—Ä–∏ `enabled: false`, –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π `status`:
  - `isIdle`
  - `isLoading`
  - `isError`
  - `isSuccess`
- `data` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `undefined`)
- `error` - –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `null`)
- `isFetching` - `true`, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–≤–∫–ª—é—á–∞—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ)
- `refetch` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
  `remove` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –∏–∑ –∫—ç—à–∞

### useQueries

–•—É–∫ `useQueries` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```js
const results = useQueries([
  { queryKey: ['post', 1], queryFn: fetchPost },
  { queryKey: ['post', 2], queryFn: fetchPost },
]);
```

–•—É–∫ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

### useInfiniteQuery

```js
const {
  fetchNextPage,
  fetchPreviousPage,
  hasNextPage,
  hasPreviousPage,
  isFetchingNextPage,
  isFetchingPreviousPage,
  ...result
} = useInfiniteQuery(
  queryKey,
  ({ pageParam = 1 }) => fetchPage(pageParam),
  {
    ...options,
    getNextPageParam: (lastPage, allPages) =>
      lastPage.nextCursor,
    getPreviousPageParam: (firstPage, allPages) =>
      firstPage.prevCursor,
  }
);
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è `useInfiniteQuery` –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º `useQuery`, –∫—Ä–æ–º–µ —Å–ª–µ–¥—É—é—â–∏—Ö:

- `queryFn` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç `QueryFunctionContext` —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ `queryKey` –∏ `pageParam`. –î–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—Ä–æ–º–∏—Å, —Ä–∞–∑—Ä–µ—à–∞—é—â–∏–π—Å—è –¥–∞–Ω–Ω—ã–º–∏ –∏–ª–∏ –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—â–∏–π –∏—Å–∫–ª—é—á–µ–Ω–∏–µ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ `pageParam`, –µ—Å–ª–∏ —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π
- `getNextPageParam` - –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–º, —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∞—Å—Å–∏–≤ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü. –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –≤ —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–ø—Ä–æ—Å–∞. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `undefined` –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `getPreviousPageParam` - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `getNextPageParam`, –Ω–æ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

#### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

–ó–Ω–∞—á–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ `useInfiniteQuery`, –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è–º, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–º `useQuery`, –∫—Ä–æ–º–µ —Å–ª–µ–¥—É—é—â–∏—Ö:

- `data.pages` - –º–∞—Å—Å–∏–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `data.pageParams` - –º–∞—Å—Å–∏–≤, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `fetchNextPage` - —Ñ—É–Ω–∫—Ü–∏—è, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –ø–æ–ª—É—á–∞—Ç—å —Å–ª–µ–¥—É—é—â—É—é "—Å—Ç—Ä–∞–Ω–∏—Ü—É" —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤. `options.pageParam` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—Ä—É—á–Ω—É—é –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤–º–µ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `getNextPageParam`
- `fetchPreviousPage` - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `fetchNextPage`, –Ω–æ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- `hasNextPage` - –∏–º–µ–µ—Ç—Å—è –ª–∏ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è
- `hasPreviousPage` - –∏–º–µ–µ—Ç—Å—è –ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è

### useMutation

```js
const {
  data,
  error,
  isError,
  isIdle,
  isLoading,
  isPaused,
  isSuccess,
  mutate,
  mutateAsync,
  reset,
  status,
} = useMutation(mutationFn, {
  mutationKey,
  onError,
  onMutate,
  onSettled,
  onSuccess,
  useErrorBoundary,
});

mutate(variables, {
  onError,
  onSettled,
  onSuccess,
});
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- `mutationFn` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è—é—â–∞—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –∑–∞–¥–∞—á—É –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –ø—Ä–æ–º–∏—Å. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –æ–±—ä–µ–∫—Ç `variables` –¥–ª—è –º—É—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- `mutationKey` - —Å—Ç—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å –ø–æ–º–æ—â—å—é `queryClient.setMutationDefaults`, –∞ —Ç–∞–∫–∂–µ –¥–ª—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –º—É—Ç–∞—Ü–∏–∏ –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞
- `onMutate` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –ø–µ—Ä–µ–¥ –º—É—Ç–∞—Ü–∏–µ–π, –ø—Ä–∏–Ω–∏–º–∞—é—â–∞—è —Ç–µ –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –≤ –Ω–∞–¥–µ–∂–¥–µ, —á—Ç–æ –º—É—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ. –í —Å–ª—É—á–∞–µ –ø—Ä–æ–≤–∞–ª–∞ –º—É—Ç–∞—Ü–∏–∏, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–µ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω–æ –≤ `onError` –∏ `onSettled`
- `onSuccess` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –ø—Ä–∏ —É—Å–ø–µ—Ö–µ –º—É—Ç–∞—Ü–∏–∏. –ï—Å–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–æ–º–∏—Å, –æ–Ω –±—É–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º
- `onError` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –º—É—Ç–∞—Ü–∏–∏. –ï—Å–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–æ–º–∏—Å, –æ–Ω –±—É–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º
- `onSettled` - —Ñ—É–Ω–∫—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º–∞—è –∫–∞–∫ –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, —Ç–∞–∫ –∏ –ø—Ä–∏ –ø—Ä–æ–≤–∞–ª–µ –º—É—Ç–∞—Ü–∏–∏. –ï—Å–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–æ–º–∏—Å, –æ–Ω –±—É–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω –ø–µ—Ä–µ–¥ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ–º
- `retry` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º—É—Ç–∞—Ü–∏–∏ (`true` - –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫)
- `retryDelay` - –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ `retryDelay` –∑–∞–ø—Ä–æ—Å–∞
- `useErrorBoundary` - –µ—Å–ª–∏ `true`, –æ—à–∏–±–∫–∏, –≤–æ–∑–Ω–∏–∫—à–∏–µ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º—É—Ç–∞—Ü–∏–∏, –≤—ã–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –∏ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –±–ª–∏–∂–∞–π—à–µ–º—É –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—é

#### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

- `mutate` - —Ñ—É–Ω–∫—Ü–∏—è –º—É—Ç–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –º—É—Ç–∞—Ü–∏–∏ –∏, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –≤ `useMutation`
- `mutateAsync` - —Ñ—É–Ω–∫—Ü–∏—è, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è `mutate`, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∞—è –ø—Ä–æ–º–∏—Å
- `status` - –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
  - `idle`
  - `loading`
  - `error`
  - `success`
- `isIdle`, `isLoading`, `isError`, `isSuccess` - –ø—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è `status`
- `data` - –ø–æ—Å–ª–µ–¥–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `undefined`)
- `error` - –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `null`)
- `reset` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º—É—Ç–∞—Ü–∏–∏

### useIsFetching

`useIsFetching` - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ö—É–∫, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ. –ú–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∑–∞–≥—Ä—É–∑–∫–∏:

```js
import { useIsFetching } from 'react-query';
// –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è?
const isFetching = useIsFetching();
// –°–∫–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤, –∫–ª—é—á–∏ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `posts`?
const isFetchingPosts = useIsFetching(['posts']);
```

–ù–∞—Å—Ç—Ä–æ–π–∫–∏:

- `queryKey` - –∫–ª—é—á –∑–∞–ø—Ä–æ—Å–∞
- `filters` - —Ñ–∏–ª—å—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –≤—ã–ø–æ–ª–Ω—è–µ–º—ã—Ö –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

### QueryClient

`QueryClient` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫—ç—à–µ–º:

```js
import { QueryClient } from 'react-query';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: Infinity,
    },
  },
});

await queryClient.prefetchQuery('posts', fetchPosts);
```

–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã:

- `fetchQuery`
- `fetchInfiniteQuery`
- `prefetchQuery`
- `prefetchInfiniteQuery`
- `getQueryData`
- `setQueryData`
- `getQueryState`
- `invalidateQueries`
- `refetchQueries`
- `cancelQueries`
- `removeQueries`
- `resetQueries`
- `isFetching`
- `getDefaultOptions`
- `setDefaultOptions`
- `getQueryDefaults`
- `setQueryDefaults`
- `getMutationDefaults`
- `setMutationDefaults`
- `getQueryCache`
- `getMutationCache`
- `clear`

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏

- `queryCache` - –∫—ç—à –∑–∞–ø—Ä–æ—Å–∞, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–¥–∫–ª—é—á–µ–Ω –¥–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
- `mutationCache` - –∫—ç—à –º—É—Ç–∞—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ–¥–∫–ª—é—á–µ–Ω –¥–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç
- `defaultOptions` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ—á–∞–Ω–∏—é –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –º—É—Ç–∞—Ü–∏–π

#### –ú–µ—Ç–æ–¥—ã

##### `fetchQuery`

`fetchQuery` - —ç—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –Ω–∞–º –Ω–µ –Ω—É–∂–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø—Ä–æ—Å–∞, —Ç–æ –≤–º–µ—Å—Ç–æ `fetchQuery` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prefetchQuery`.

–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω—ã –∏–ª–∏ –Ω–µ —Å—Ç–∞—Ä—à–µ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ `staleTime`, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫—ç—à–∞. –í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ, –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `fetchQuery` –∏ `setQueryData` —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ `fetchQuery` —è–≤–ª—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –ø–æ–º–æ—â—å—é —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ `useQuery` –Ω–µ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–¥–ª—è –æ—Ç—Ä–µ–Ω–¥–µ—Ä–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –≤–æ –≤—Ä–µ–º—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö).

```js
try {
  const data = await queryClient.fetchQuery(
    queryKey,
    queryFn
  );
} catch (error) {
  console.log(error);
}
```

–° –ø–æ–º–æ—â—å—é `staleTime` –º–æ–∂–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏:

```js
try {
  const data = await queryClient.fetchQuery(
    queryKey,
    queryFn,
    {
      staleTime: 10000,
    }
  );
} catch (error) {
  console.log(error);
}
```

##### `fetchInfiniteQuery`

`fetchInfiniteQuery` –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω `fetchQuery`, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:

```js
try {
  const data = await queryClient.fetchInfiniteQuery(
    queryKey,
    queryFn
  );
  console.log(data.pages);
} catch (error) {
  console.log(error);
}
```

##### `prefetchQuery`

`prefetchQuery` - —ç—Ç–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞, –ø–µ—Ä–µ–¥ –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –∏–ª–∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–æ–º —Å –ø–æ–º–æ—â—å—é `useQuery`. –í —Ü–µ–ª–æ–º, –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫ –∂–µ, –∫–∞–∫ `fetchQuery`.

##### `prefetchInfiniteQuery`

`prefetchInfiniteQuery` –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω `prefetchQuery`, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

##### `getQueryData`

`getQueryData` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `undefined`.

```js
const data = queryClient.getQueryData(queryKey);
```

##### `setQueryData`

`setQueryData` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –Ω–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –æ–Ω —Å–æ–∑–¥–∞–µ—Ç—Å—è. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ö—É–∫–æ–º –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –ø—è—Ç–∏ –º–∏–Ω—É—Ç `cacheTime`, –æ–Ω —É–Ω–∏—á—Ç–æ–∂–∞–µ—Ç—Å—è —Å–±–æ—Ä—â–∏–∫–æ–º –º—É—Å–æ—Ä–∞.

```js
queryClient.setQueryData(queryKey, updater);
```

##### `getQueryState`

`getQueryState` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `undefined`

```js
const state = queryClient.getQueryState(queryKey);
console.log(state.dataUpdatedAt);
```

##### `invalidateQueries`

–ú–µ—Ç–æ–¥ `invalidateQueries` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫—ç—à–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –∫–ª—é—á–µ–π –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤/—Å–æ—Å—Ç–æ—è–Ω–∏—è. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é, –≤—Å–µ —Å–æ–≤–ø–∞–≤—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –∞–Ω–Ω—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–≤—Ç–æ—Ä–Ω–æ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

- –î–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `refetchActive: false`
- –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `refetchInactive: true`

```js
await queryClient.invalidateQueries(
  'posts',
  {
    exact,
    refetchActive: true,
    refetchInactive: false,
  },
  { throwOnError }
);
```

##### `refetchQueries`

–ú–µ—Ç–æ–¥ `refetchQueries` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π.

```js
// –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã
await queryClient.refetchQueries();

// –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø—Ä–æ—Å—ã
await queryClient.refetchQueries({ stale: true });

// –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —á–∞—Å—Ç–∏—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å –∫–ª—é—á–æ–º
await queryClient.refetchQueries(['posts'], {
  active: true,
});

// –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—â–∏–µ —Å –∫–ª—é—á–æ–º
await queryClient.refetchQueries(['posts', 1], {
  active: true,
  exact: true,
});
```

##### `cancelQueries`

–ú–µ—Ç–æ–¥ `cancelQueries` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–º–µ–Ω—ã –∏—Å—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –∫–ª—é—á–µ–π –∏–ª–∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤/—Å–æ—Å—Ç–æ—è–Ω–∏—è.

–≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π, –∫–æ–≥–¥–∞ –º—ã –Ω–µ —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã –≤—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è –∑–∞–ø—Ä–æ—Å—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª–∏ —Ç–∞–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

```js
await queryClient.cancelQueries('posts', { exact: true });
```

##### `removeQueries`

–ú–µ—Ç–æ–¥ `removeQueries` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –∫—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –∫–ª—é—á–µ–π –∏–ª–∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤/—Å–æ—Å—Ç–æ—è–Ω–∏—è.

```js
queryClient.removeQueries(queryKey, { exact: true });
```

##### `resetQueries`

–ú–µ—Ç–æ–¥ `resetQueries` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–±—Ä–æ—Å–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –∫—ç—à–µ –∫ –∏—Ö –Ω–∞—á–∞–ª—å–Ω–æ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª—é—á–µ–π –∏–ª–∏ –ª—é–±—ã—Ö –¥—Ä—É–≥–∏—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–≤–æ–π—Å—Ç–≤/—Å–æ—Å—Ç–æ—è–Ω–∏—è.

–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —É–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤, –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `clear`, –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–µ—Ç –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç `initialData`, –æ–Ω –±—É–¥–µ—Ç —Å–±—Ä–æ—à–µ–Ω –∫ –Ω–∏–º. –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —è–≤–ª—è–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, –æ–Ω –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω –ø–æ–≤—Ç–æ—Ä–Ω–æ.

```js
queryClient.resetQueries(queryKey, { exact: true });
```

##### `isFetching`

–ú–µ—Ç–æ–¥ `isFetching` –ø–æ—Ö–æ–∂ –Ω–∞ —Ö—É–∫ `useIsFetching`. –û–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤, –Ω–∞—Ö–æ–¥—è—â–∏—Ö—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

```js
if (queryClient.isFetching()) {
  console.log(
    '–ö–∞–∫ –º–∏–Ω–∏–º—É–º, –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è!'
  );
}
```

##### `getDefaultOptions` –∏ `setDefaultOptions`

`getDefaultOptions` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞ –∏–ª–∏ —Å –ø–æ–º–æ—â—å—é `setDefaultOptions`. `setDefaultOptions` –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

##### `getQueryDefaults` –∏ `setQueryDefaults`

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã `getDefaultOptions` –∏ `setDefaultOptions`, –Ω–æ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.

##### `getMutationDefaults` –∏ `setMutationDefaults`

–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã `getDefaultOptions` –∏ `setDefaultOptions`, –Ω–æ –≤ –æ—Ç–Ω–æ—à–µ–Ω–∏–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –º—É—Ç–∞—Ü–∏–π.

##### `getQueryCache` –∏ `getMutationCache`

–î–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∫—ç—à –∑–∞–ø—Ä–æ—Å–∞ –∏ –∫—ç—à –º—É—Ç–∞—Ü–∏–∏, –∫ –∫–æ—Ç–æ—Ä—ã–º –ø–æ–¥–∫–ª—é—á–µ–Ω –¥–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç.

##### `clear`

–ú–µ—Ç–æ–¥ `clear` –æ—á–∏—â–∞–µ—Ç –≤—Å–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ –∫—ç—à–∏.

```js
queryClient.clear();
```

### QueryClientProvider

`QueryClientProvider` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–¥–∞—á–∏ `QueryClient` –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:

```js
import {
  QueryClient,
  QueryClientProvider,
} from 'react-query';

const queryClient = new QueryClient();

const App = () => (
  <QueryClientProvider client={queryClient}>
    ...
  </QueryClientProvider>
);
```

### useQueryClient

–•—É–∫ `useQueryClient` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä `QueryClient`:

```js
import { useQueryClient } from 'react-query';

const queryClient = useQueryClient();
```

### QueryObserver

`QueryObserver` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏:

```js
const observer = new QueryObserver(queryClient, {
  queryKey: 'posts',
});

const unsubscribe = observer.subscribe((result) => {
  console.log(result);
  unsubscribe();
});
```

### InfiniteQueryObserver

`InfiniteQueryObserver` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–µ–∂–¥—É –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏:

```js
const observer = new InfiniteQueryObserver(queryClient, {
  queryKey: 'posts',
  queryFn: fetchPosts,
  getNextPageParam: (lastPage, allPages) =>
    lastPage.nextCursor,
  getPreviousPageParam: (firstPage, allPages) =>
    firstPage.prevCursor,
});

const unsubscribe = observer.subscribe((result) => {
  console.log(result);
  unsubscribe();
});
```

### QueriesObserver

`QueriesObserver` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏:

```js
const observer = new QueriesObserver(queryClient, [
  { queryKey: ['post', 1], queryFn: fetchPost },
  { queryKey: ['post', 2], queryFn: fetchPost },
]);

const unsubscribe = observer.subscribe((result) => {
  console.log(result);
  unsubscribe();
});
```
